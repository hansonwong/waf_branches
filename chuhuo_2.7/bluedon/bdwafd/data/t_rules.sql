INSERT INTO `t_rules` VALUES (90143,900046,'检测全局参数cache-control值以及响应头部Cache-Control字段(Application Defects)','GLOBAL:CHECK_CACHE_CONTROL "@le 10"','如果全局参数cache-control值少于等于10，则记录日志，如果响应头部的Cache-Control字段没有包含no-store，则设置相应的缓存参数值(Application Defects)','OTHER','block',0,1452647413,NULL),(90123,900047,'初始化XSS攻击防护动作为“继续处理”，并设置相关参数(Application Defects)','xss_list','初始化XSS攻击防护动作为“继续处理”，并设置相关参数(Application Defects)','OTHER','block',0,1452647413,NULL),(90144,900048,'检测请求体中是否包含恶意的Meta-Characters(Application Defects)','&ARGS "@gt 0"','如果请求体中含有恶意的Meta-Characters，则禁止访问，返回403错误，并记录日志(Application Defects)','OTHER','block',0,1452647413,NULL),(90149,981180,'检测XSS数据是否在全局变量列表里（Application Defects）','@streq %{tx.inbound_meta-characters}','如果XSS数据已经在全局变量列表里，则跳过规则（Application Defects）','OTHER','block',0,1452647413,NULL),(90148,981181,'检测请求数据中的INBOUND_META-CHARACTERS是否匹配规则（Application Defects）','TX:INBOUND_META-CHARACTERS ".*"','如果匹配，则设置global的XSS列表参数（Application Defects）','OTHER','block',0,1452647413,NULL),(90147,981182,'检测响应数据中是否包含已知的恶意字符（Application Defects）','@within %{response_body} ','检测响应数据中是否包含已知的恶意字符，如果有，则记录日志（Application Defects）','OTHER','block',0,1452647413,NULL),(90146,981184,'检测响应数据中是否缺少Cookies HttpOnly标志（Application Defects）','"(.*?)=(?i)(?!.*httponly.*)(.*$)"','如果响应数据中缺少Cookies HttpOnly标志，则记录日志（Application Defects）','OTHER','block',0,1452647413,NULL),(90145,981185,'检测响应数据中是否缺少Cookies Secure标志（Application Defects）','"(.*?)=(?i)(?!.*secure.*)(.*$)"','如果响应数据中缺少Cookies Secure标志，则记录日志（Application Defects）','OTHER','block',0,1452647413,NULL),(90140,981220,'检测正常返回的xml类型响应数据是否缺少字符集（Application Defects）','GLOBAL:MISSING_CHARSET "@le 10"','MISSING_CHARSET少于等于10，说明正常返回的xml类型响应数据缺少字符（Application Defects）','OTHER','pass',0,1452647413,NULL),(90141,981221,'检测GLOBAL集合的参数CHARSET_NOT_UTF8是否为0（Application Defects）','&GLOBAL:CHARSET_NOT_UTF8 "@eq 0" ','如果GLOBAL集合的参数CHARSET_NOT_UTF8为0 ，则设置参数global.charset_not_utf8=0（Application Defects）','OTHER','pass',0,1452647413,NULL),(90138,981222,'检测正常返回的Html/xml类型响应数据是否明确设置UTF-8（Application Defects）','GLOBAL:CHARSET_NOT_UTF8 "@le 10"','CHARSET_NOT_UTF8少于等于10，说明正常返回的Html/xml类型响应数据没有明确设置UTF-8（Application Defects）','OTHER','pass',0,1452647413,NULL),(90139,981223,'检测GLOBAL集合的参数CHARSET_MISMATCH是否为0 （Application Defects）','&GLOBAL:CHARSET_MISMATCH "@eq 0"','如果GLOBAL集合的参数CHARSET_MISMATCH为0 ，则设置参数global.charset_mismatch=0（Application Defects）','OTHER','pass',0,1452647413,NULL),(90142,981224,'检测正常返回的Html/xml类型响应数据的头部字符集和Html/xml响应体字符集是否一致（Application Defects）','GLOBAL:CHARSET_MISMATCH "@le 10"','CHARSET_MISMATCH少于等于10，说明正常返回的Html/xml类型响应数据的头部字符集和Html/xml响应体字符集不一致（Application Defects）','OTHER','pass',0,1452647413,NULL),(90125,981235,'检测全局集合中的MISSING_HTTPONLY参数值是否为0（Application Defects）','&GLOBAL:MISSING_HTTPONLY "@eq 0"','如果MISSING_HTTPONLY参数值为0，则设置参数global.missing_httponly=0（Application Defects）','OTHER','block',0,1452647413,NULL),(90127,981236,'检测全局集合中的MISSING_SECURE参数值是否为0（Application Defects）','&GLOBAL:MISSING_SECURE "@eq 0"','如果MISSING_SECURE参数值为0，则设置参数global.missing_secure=0（Application Defects）','OTHER','block',0,1452647413,NULL),(90126,981237,'检测全局集合中的LOOSE_DOMAIN_SCOPE参数值是否为0（Application Defects）','&GLOBAL:LOOSE_DOMAIN_SCOPE "@eq 0"','如果LOOSE_DOMAIN_SCOPE参数值为0，则设置参数global.loose_domain_scope=0（Application Defects）','OTHER','block',0,1452647413,NULL),(90129,981238,'检测cookies内容（Application Defects）','GLOBAL:LOOSE_DOMAIN_SCOPE "@le 10"','检测cookies内容（Application Defects）','OTHER','block',0,1452647413,NULL),(90128,981239,'检测全局集合中的CHECK_CACHE_CONTROL参数值是否为0（Application Defects）','&GLOBAL:CHECK_CACHE_CONTROL "@eq 0"','如果CHECK_CACHE_CONTROL参数值为0，则设置参数global.check_cache_control=0（Application Defects）','OTHER','block',0,1452647413,NULL),(90132,981400,'检测全局集合参数CONTENT_TYPE_HEADER_EXISTS的值（Application Defects）','&GLOBAL:CONTENT_TYPE_HEADER_EXISTS "@eq 0"','如果全局集合参数CONTENT_TYPE_HEADER_EXISTS的值为0 ，则设置参数global.content_type_header_exists=0（Application Defects）','OTHER','block',0,1452647413,NULL),(90133,981401,'检测http响应头是否含有Content-Type字段内容（Application Defects）','GLOBAL:CONTENT_TYPE_HEADER_EXISTS "@le 10"','CONTENT_TYPE_HEADER_EXISTS参数值少于或等于10，说明http响应头没有Content-Type字段或者该字段内容为空（Application Defects）','OTHER','block',0,1452647413,NULL),(90130,981402,'检测全局集合参数X_XSS_PROTECTION_DISABLED的值（Application Defects）','&GLOBAL:X_XSS_PROTECTION_DISABLED "@eq 0"','如果全局集合参数CONTENT_TYPE_HEADER_EXISTS的值为0 ，则设置参数global.x_xss_protection_disabled=0（Application Defects）','OTHER','block',0,1452647413,NULL), (90131,981403,'检测IE浏览器的XSS防护过滤功能是否启用（Application Defects）','GLOBAL:X_XSS_PROTECTION_DISABLED "@le 10"','X_XSS_PROTECTION_DISABLED参数值少于或等于10，说明IE浏览器的XSS防护过滤功能没有启用（Application Defects）','OTHER','block',0,1452647413,NULL),(90136,981404,'检测全局集合参数X_FRAME_OPTIONS的值（Application Defects）','&GLOBAL:X_FRAME_OPTIONS "@eq 0"','如果全局集合参数X_FRAME_OPTIONS的值为0 ，则设置参数global.x_frame_options=0（Application Defects）','OTHER','block',0,1452647413,NULL),(90137,981405,'检测http响应头是否含有X-FRAME-OPTIONS字段内容（Application Defects）','GLOBAL:X_FRAME_OPTIONS "@le 10"','X_FRAME_OPTIONS参数值少于或等于10，说明http响应头没有X-FRAME-OPTIONS字段或者该字段内容为空（Application Defects）','OTHER','block',0,1452647413,NULL),(90134,981406,'检测全局集合参数X_CONTENT_TYPE_OPTIONS的值（Application Defects）','&GLOBAL:X_CONTENT_TYPE_OPTIONS "@eq 0"','如果全局集合参数X_CONTENT_TYPE_OPTIONS的值为0 ，则设置参数global.x_content_type_options=0（Application Defects）','OTHER','block',0,1452647413,NULL),(90135,981407,'检测http响应头的Content-Type字段内容及X_CONTENT_TYPE_OPTIONS是否缺少（Application Defects）','&RESPONSE_HEADERS:Content-Type|RESPONSE_HEADERS:Content-Type "^0$|^$"','如果匹配规则，则说明响应头部缺少Content-Type字段并且缺少X-Content-Type-Options字段或该字段没有设置成nosniff（Application Defects）','OTHER','block',0,1452647413,NULL),(90120,981082,'初始化资源收集的默认行为是"继续处理"（AppSensor Detection）','resource=%{request_headers.host}_%{request_filename},resource.min_pattern_threshold=50,resource.min_traffic_threshold=100','初始化资源收集的默认行为是"继续处理"，无日志记录，初始化相关参数（AppSensor Detection）','OTHER','block',0,1452647413,NULL),(90033,981085,'检测esource.enforce_profile的参数是否为0（AppSensor Detection）','&RESOURCE:ENFORCE_RE_PROFILE "@eq 0"','如果esource.enforce_profile参数为0，则跳过profile enforcement规则检测（AppSensor Detection）','OTHER','block',0,1452647413,NULL),(90031,981086,'检测esource.enforce_profile的参数是否为1（AppSensor Detection）','&RESOURCE:ENFORCE_RE_PROFILE "@eq 1"','如果esource.enforce_profile参数为1，则执行对应文件appsensor_request_exception_enforce.lua（AppSensor Detection）','OTHER','block',0,1452647413,NULL),(90032,981087,'检测是否调用了不支持的http请求方法（AppSensor Detection）','REQUEST_METHOD "!@within HEAD GET POST PUT DELETE TRACE OPTIONS CONNECT"','如果调用了不支持的http请求方法，则阻断，并记录（AppSensor Detection）','OTHER','block',0,1452647413,NULL),(90034,981088,'检测请求方法是否不合规范（AppSensor Detection）','TX:REQUEST_METHOD_VIOLATION "@eq 1"','如果存在不合规范的请求方法，则阻断访问，并设置相关参数（AppSensor Detection）','OTHER','block',0,1452647413,NULL),(90035,981089,'检测请求中是否缺少参数（AppSensor Detection）','TX:MIN_NUM_ARGS_VIOLATION "@eq 1"','如果请求中缺少参数，则阻断访问（AppSensor Detection）','OTHER','block',0,1452647413,NULL),(90020,981090,'检测请求中是否有额外参数（AppSensor Detection）','TX:MAX_NUM_ARGS_VIOLATION "@eq 1"','如果请求中有额外参数，则阻断访问（AppSensor Detection）','OTHER','block',0,1452647413,NULL),(90019,981091,'检测请求参数的名称（AppSensor Detection）','TX:ARGS_NAMES_VIOLATION ".*"','如果请求参数的名称违反规定，则阻断访问（AppSensor Detection）','OTHER','block',0,1452647413,NULL),(90022,981092,'检测请求参数的长度是否比正常范围小（AppSensor Detection）','TX:/^ARGS.*_MIN_LENGTH_VIOLATION/ ".*" ','如果请求参数的长度比正常范围小，则阻断访问（AppSensor Detection）','OTHER','block',0,1452647413,NULL),(90021,981093,'检测请求参数的长度是否比正常范围大（AppSensor Detection）','TX:/^ARGS.*_MAX_LENGTH_VIOLATION/ ".*"','如果请求参数的长度比正常范围大，则阻断访问（AppSensor Detection）','OTHER','block',0,1452647413,NULL),(90016,981094,'检测请求参数中是否包含意料之外的Digits字符（AppSensor Detection）','TX:/^ARGS.*_digits_violation/ ".*"','如果请求参数中包含意料之外的Digits字符，则阻断访问（AppSensor Detection）','OTHER','block',0,1452647413,NULL),(90015,981095,'检测请求参数中是否包含意料之外的Alpha字符（AppSensor Detection）','TX:/^ARGS.*_alpha_violation/ ".*"','如果请求参数中包含意料之外的Alpha字符，则阻断访问（AppSensor Detection）','OTHER','block',0,1452647413,NULL),(90018,981096,'检测请求参数中是否包含意料之外的AlphaNumeric字符（AppSensor Detection）','TX:/^ARGS.*_alphanumeric_violation/ ".*"','如果请求参数中包含意料之外的AlphaNumeric字符，则阻断访问（AppSensor Detection）','OTHER','block',0,1452647413,NULL),(90017,981097,'检测请求参数中是否包含意料之外的Email字符（AppSensor Detection）','TX:/^ARGS.*_email_violation/ ".*"','如果请求参数中包含意料之外的Email字符，则阻断访问（AppSensor Detection）','OTHER','block',0,1452647413,NULL),(90024,981098,'初始化配置文件分析阶段访问行为默认了"仅检测"（AppSensor Detection）','ruleEngine=DetectionOnly','初始化配置文件分析阶段访问行为默认了"仅检测"，无日志记录（AppSensor Detection）','OTHER','block',0,1452647413,NULL),(90023,981099,'检测请求状态码是不是404（AppSensor Detection）','RESPONSE_STATUS "^404$"','如果请求状态码是404，则设置resource.KEY值为FLASE，并跳过profile analysis规则检测（AppSensor Detection）','OTHER','block',0,1452647413,NULL),(90030,981100,'检测请求状态码是否以4或5开头的（AppSensor Detection）','RESPONSE_STATUS "^(5|4)"','如果请求状态码是以4或5开头的，则跳过profile analysis规则检测（AppSensor Detection）','OTHER','block',0,1452647413,NULL),(90029,981101,'检测请求中的ANOMALY_SCORE的数值是否不为0（AppSensor Detection）','TX:ANOMALY_SCORE "!@eq 0" ','如果请求中的ANOMALY_SCORE的数值不为0，则跳过profile analysis规则检测（AppSensor Detection）','OTHER','block',0,1452647413,NULL),(90028,981102,'检测请求源中的ENFORCE_RE_PROFILE是否为1（AppSensor Detection）','&RESOURCE:ENFORCE_RE_PROFILE "@eq 1" ','如果请求源中的ENFORCE_RE_PROFILE为1，则跳过profile analysis规则检测（AppSensor Detection）','OTHER','block',0,1452647413,NULL),(90027,981103,'检测请求参数中是否包含意料之外的Path字符类（AppSensor Detection）','TX:/^ARGS.*_path_violation/ ".*"','如果请求参数中包含意料之外的Path字符，则阻断访问（AppSensor Detection）','OTHER','block',0,1452647413,NULL),(90026,981104,'检测请求参数中是否包含意料之外的URL字符类（AppSensor Detection）','TX:/^ARGS.*_url_violation/ ".*"','如果请求参数中包含意料之外的URL字符，则阻断访问（AppSensor Detection）','OTHER','block',0,1452647413,NULL),(90025,981105,'检测请求参数中是否包含意料之外的SafeText字符类（AppSensor Detection）','TX:/^ARGS.*_safetext_violation/ ".*"','如果请求参数中包含意料之外的SafeText字符，则阻断访问（AppSensor Detection）','OTHER','block',0,1452647413,NULL),(90014,981110,'检测请求参数中是否包含意料之外的Flag字符类（AppSensor Detection）','TX:/^ARGS.*_flag_violation/ ".*"','如果请求参数中包含意料之外的Flag字符，则阻断访问（AppSensor Detection）','OTHER','block',0,1452647413,NULL),(90008,981131,'检测AppSensor里的DEBUG参数（AppSensor Detection）','ARGS:DEBUG "!@streq false" ','如果AppSensor里的DEBUG参数不为false，则阻断，并记录（AppSensor Detection）','OTHER','block',0,1452647413,NULL),(90007,981132,'在stream_output_body中添加一个假的"debug"参数（AppSensor Detection）','STREAM_OUTPUT_BODY "@rsub s/<\\/form>/<input type=\\"hidden\\" name=\\"debug\\" value=\\"false\\"><\\/form>/" ','在stream_output_body中添加一个假的"debug"参数（AppSensor Detection）','OTHER','block',0,1452647413,NULL),(90048,950115,'使用AV扫描脚本或工具来检测上传文件是否包含病毒（AV Scanning）','@inspectFile /bin/runAV','使用AV扫描脚本或工具来检测上传文件是否包含病毒（AV Scanning）','OTHER','block',0,1452647413,NULL),(90118,990002,'检测请求头中的User-Agent字段内容1(Bat Robots)','REQUEST_HEADERS:User-Agent "@pmFromFile modsecurity_35_scanners.data"','检测请求头中的User-Agent字段内容是否与modsecurity_35_scanners.data列表的短语匹配,如果匹配，则阻断访问，并设置相关参数值(Bat Robots)','OTHER','block',0,1452647413,NULL),(90116,990012,'检测请求头中的User-Agent字段内容2(Bat Robots)','REQUEST_HEADERS:User-Agent "@pmFromFile modsecurity_35_bad_robots.data"','检测请求头中的User-Agent字段内容是否与modsecurity_35_bad_robots.data列表的短语匹配,如果匹配，则阻断访问，并设置相关参数值(Bat Robots)','OTHER','block',0,1452647413,NULL),(90117,990901,'检测请求头名称(Bat Robots)','REQUEST_HEADERS_NAMES "\\bacunetix-product\\b"','如果匹配，则阻断访问，并设置相关参数值(Bat Robots)','OTHER','block',0,1452647413,NULL),(90119,990902,'检测请求文件名(Bat Robots)','REQUEST_FILENAME "@pm nessustest appscan_fingerprint"','如果请求文件名是nessustest或appscan_fingerprint，则阻断访问，并设置相关参数值(Bat Robots)','OTHER','block',0,1452647413,NULL),(90036,900033,'检测是否发生web攻击（Bayes Analysis)','d.*WEB_ATTACK/' ,'如果发生web攻击，则记录日志，并执行bayes_train_spam.lua脚本（Bayes Analysis)','OTHER','block',0,1452647413,NULL),(90037,900034,'执行bayes_check_spam.lua脚本（Bayes Analysis)','SecRuleScript lua/bayes_check_spam.lua','执行bayes_check_spam.lua脚本，发生阻断（Bayes Analysis)','OTHER','block',0,1452647413,NULL),(90038,900035,'检测异常分数是否为0（Bayes Analysis)','&TX:ANOMALY_SCORE "@eq 0" ','如果异常分数为0，则记录日志，并执行bayes_train_ham.lua脚本（Bayes Analysis)','OTHER','block',0,1452647413,NULL),(0,981036,'检测是否发生了Brute Force Attack 阻断（Brute Force）','IP:BRUTE_FORCE_BLOCK "@eq 1"','如果发生了Brute Force Attack 阻断，则累计阻断次数，并记录日志（Brute Force）','OTHER','block',1,1452647413,NULL),(0,981037,'检测是否发生了Brute Force Attack 阻断（无日志）（Brute Force）','&IP:BRUTE_FORCE_BLOCK_FLAG "@eq 0"','如果发生了Brute Force Attack 阻断，则累计阻断次数，但不记录日志（Brute Force）','OTHER','block',1,1452647413,NULL),(0,981038,'检测用户是否在10个Brute Force Protection配置文件中定义了一些URL（Brute Force）','&TX:BRUTE_FORCE_PROTECTED_URLS "@eq 0"','如果用户没有在10个Brute Force Protection配置文件中定义了任何URL，则跳过Brute Force Protection规则检测（Brute Force）','OTHER','block',1,1452647413,NULL),(0,981039,'获取Brute Force Protection文件名（Brute Force）','REQUEST_FILENAME ".*"','获取Brute Force Protection文件名（Brute Force）','OTHER','block',1,1452647413,NULL),(0,981040,'检测当前IP地址是否因为高请求而被阻断（Brute Force Protection）（Brute Force）','IP:BRUTE_FORCE_BLOCK "@eq 1" ','如果当前IP地址因为高请求而被阻断，则跳过Brute Force Protection检测（Brute Force）','OTHER','block',1,1452647413,NULL),(0,981041,'初始化行为，不断累计Brute Force Protection请求源的个数（Brute Force）','ip.brute_force_counter=+1','初始化行为，累计Brute Force Protection请求源的个数（Brute Force）','OTHER','block',1,1452647413,NULL),(0,981042,'检测Brute Force请求数值（Brute Force）','IP:BRUTE_FORCE_COUNTER "@gt 0"','如果Brute Force请求数值在5分钟内大于或等于50，则设置burst数值（Brute Force）','OTHER','block',1,1452647413,NULL),(0,981043,'检测Burst数值（Brute Force）','&IP:BRUTE_FORCE_COUNTER_FLAG "@eq 0"','如果Burst数值大于或等于2，则设置IP阻断数值为每5分钟阻断一次并发出告警（Brute Force）','OTHER','block',1,1452647413,NULL),(0,981047,'根据网页名称判断是否为动态网页来源然后累计Dos攻击请求数（Brute Force）','REQUEST_BASENAME "!\\.(jpe?g|png|gif|js|css|ico)$"','根据网页名称判断是否为动态网页来源然后累计Dos攻击请求数(Dos Protection)','OTHER','block',1,1452647413,NULL),(90076,920005,'根据用户输入数据（日志及审查），检测已知信用卡类型（MasterCard信用卡号）（CC_Known)','?:^|[^\\d])(5[1-5]\\d{2}\\-?\\d{4}\\-?\\d{2}\\-?\\d{2}\\-?\\d{4})(?:[^\\d]|$','从用户输入数据检测到MasterCard信用卡号，记录日志（CC_Known)','OTHER','block',0,1452647413,NULL),(90082,920006,'根据用户输出数据（响应体及响应头），检测已知信用卡类型（MasterCard信用卡号）（CC_Known)','(?:^|[^\\d])(?<!google_ad_client = \\"pub-)(5[1-5]\\d{2}\\-?\\d{4}\\-?\\d{2}\\-?\\d{2}\\-?\\d{4})(?:[^\\d]|$)','从网页到用户的输出数据检测到MasterCard信用卡号，记录日志（CC_Known)','OTHER','block',0,1452647413,NULL),(90074,920007,'根据用户输入数据（日志及审查），检测已知信用卡类型（Visa信用卡号）（CC_Known)','?:^|[^\\d])(4\\d{3}\\-?\\d{4}\\-?\\d{2}\\-?\\d{2}\\-?\\d(?:\\d{3})??)(?:[^\\d]|$)','从用户输入数据检测到Visa信用卡号，记录日志（CC_Known)','OTHER','block',0,1452647413,NULL),(90077,920008,'根据用户输出数据（响应体及响应头），检测信用卡类型（Visa信用卡号）（CC_Known)','?:^|[^\\d])(?<!google_ad_client = \\"pub-)(4\\d{3}\\-?\\d{4}\\-?\\d{2}\\-?\\d{2}\\-?\\d(?:\\d{3})??)(?:[^\\d]|$','从网页到用户的输出数据检测到Visa信用卡号，记录日志（CC_Known)','OTHER','block',0,1452647413,NULL),(90072,920009,'根据用户输入数据（日志及审查），检测已知信用卡类型（American Express信用卡号）（CC_Known)','?:^|[^\\d])(3[47]\\d{2}\\-?\\d{4}\\-?\\d{2}\\-?\\d{2}\\-?\\d{3})(?:[^\\d]|$)','从用户输入数据检测到American Express信用卡号，记录日志（CC_Known)','OTHER','block',0,1452647413,NULL),(90068,920010,'根据用户输出数据（响应体及响应头），检测已知信用卡类型（American Express信用卡号）（CC_Known)','?:^|[^\\d])(?<!google_ad_client = \\"pub-)(3[47]\\d{2}\\-?\\d{4}\\-?\\d{2}\\-?\\d{2}\\-?\\d{3})(?:[^\\d]|$)','从网页到用户的输出数据检测到American Express信用卡号，记录日志（CC_Known)','OTHER','block',0,1452647413,NULL),(90069,920011,'根据用户输入数据（日志及审查），检测已知信用卡类型（Diners Club信用卡号）（CC_Known)','?:^|[^\\d])((?:30[0-5]|3[68]\\d)\\d\\-?\\d{4}\\-?\\d{2}\\-?\\d{2}\\-?\\d{2})(?:[^\\d]|$)','从用户输入数据检测到Diners Club信用卡号，记录日志（CC_Known)','OTHER','block',0,1452647413,NULL),(90070,920012,'根据用户输出数据（响应体及响应头），检测已知信用卡类型（Diners Club信用卡号）（CC_Known)','?:^|[^\\d])(?<!google_ad_client = \\"pub-)((?:30[0-5]|3[68]\\d)\\d\\-?\\d{4}\\-?\\d{2}\\-?\\d{2}\\-?\\d{2})(?:[^\\d]|$','从网页到用户的输出数据检测到Diners Club信用卡号，记录日志（CC_Known)','OTHER','block',0,1452647413,NULL),(90071,920015,'根据用户输入数据（日志及审查），检测已知信用卡类型（Discover信用卡号）（CC_Known)','?:^|[^\\d])(6(?:011|5\\d{2})\\-?\\d{4}\\-?\\d{2}\\-?\\d{2}\\-?\\d{4})(?:[^\\d]|$','从用户输入数据检测到Discover信用卡号，记录日志（CC_Known)','OTHER','block',0,1452647413,NULL),(90078,920016,'根据用户输出数据（响应体及响应头），检测已知信用卡类型（Discover信用卡号）（CC_Known)','?:^|[^\\d])(?<!google_ad_client = \\"pub-)(6(?:011|5\\d{2})\\-?\\d{4}\\-?\\d{2}\\-?\\d{2}\\-?\\d{4})(?:[^\\d]|$','从网页到用户的输出数据检测到Discover信用卡号，记录日志（CC_Known)','OTHER','block',0,1452647413,NULL),(90073,920017,'根据用户输入数据（日志及审查），检测已知信用卡类型（JCB信用卡号）（CC_Known)','?:^|[^\\d])(3\\d{3}\\-?\\d{4}\\-?\\d{2}\\-?\\d{2}\\-?\\d{4}|(?:1800|21(?:31|00))\\-?\\d{4}\\-?\\d{2}\\-?\\d{2}\\-?\\d{3})(?:[^\\d]|$','从用户输入数据检测到JCB信用卡号，记录日志（CC_Known)','OTHER','block',0,1452647413,NULL),(90079,920018,'根据用户输出数据（响应体及响应头），检测已知信用卡类型（JCB信用卡号）（CC_Known)','?:^|[^\\d])(?<!google_ad_client = \\"pub-)(3\\d{3}\\-?\\d{4}\\-?\\d{2}\\-?\\d{2}\\-?\\d{4}|(?:1800|21(?:31|00))\\-?\\d{4}\\-?\\d{2}\\-?\\d{2}\\-?\\d{3})(?:[^\\d]|$','从网页到用户的输出数据检测到JCB信用卡号，记录日志（CC_Known)','OTHER','block',0,1452647413,NULL),(90075,920019,'根据用户输入数据（日志及审查），检测已知信用卡类型（GSA SmartPay信用卡号）（CC_Known)','?:^|[^\\d])((?:5568|4(?:486|716))\\-?\\d{4}\\-?\\d{2}\\-?\\d{2}\\-?\\d{4}|8699\\-?\\d{4}\\-?\\d{2}\\-?\\d{2}\\-?\\d{3})(?:[^\\d]|$','从用户输入数据检测到GSA SmartPay信用卡号，记录日志（CC_Known)','OTHER','block',0,1452647413,NULL),(90085,920020,'根据用户输出数据（响应体及响应头），检测已知信用卡类型（GSA SmartPay信用卡号）（CC_Known)','?:^|[^\\d])(?<!google_ad_client = \\"pub-)((?:5568|4(?:486|716))\\-?\\d{4}\\-?\\d{2}\\-?\\d{2}\\-?\\d{4}|8699\\-?\\d{4}\\-?\\d{2}\\-?\\d{2}\\-?\\d{3})(?:[^\\d]|$','从网页到用户的输出数据检测到GSA SmartPay信用卡号，记录日志（CC_Known)','OTHER','block',0,1452647413,NULL),(90081,981078,'检测请求输出数据中的请求参数（CC Known）','ARGS "@verifyCC (?:^|[^\\d])(\\d{4}\\-?\\d{4}\\-?\\d{2}\\-?\\d{2}\\-?\\d{1,4})(?:[^\\d]|$)"','检测请求输出数据中的请求参数，若匹配规则，则跳过输入数据CC部分的检测规则，继续处理（CC Known）','OTHER','block',0,1452647413,NULL),(90080,981079,'初始化CC访问请求数据的默认行为是"继续处理"（CC Known）','skipAfter END_KNOWN_CC_INBOUND_CHECK','初始化CC访问请求数据的默认行为是“继续处理”,无日志记录，默认跳过END_KNOWN_CC_INBOUND_CHECK规则（CC Known）','OTHER','block',0,1452647413,NULL),(90083,981080,'检测CC响应数据中的参数（CC Known）','RESPONSE_BODY|RESPONSE_HEADERS:Location "@verifyCC (?:^|[^\\d])(?<!google_ad_client = \\"pub-)(\\d{4}\\-?\\d{4}\\-?\\d{2}\\-?\\d{2}\\-?\\d{1,4})(?:[^\\d]|$)"','检测CC响应数据中的参数，若匹配规则，则跳过响应数据中CC部分的检测规则，继续处理（CC Known）','OTHER','block',0,1452647413,NULL),(90084,981081,'初始化CC响应数据的默认行为是"继续处理"（CC Known）','skipAfter END_KNOWN_CC_OUTBOUND_CHECK','初始化CC访问响应数据的默认行为是“继续处理”,无日志记录，默认跳过END_KNOWN_CC_OUTBOUND_CHECK规则（CC Known）','OTHER','block',0,1452647413,NULL),(90167,920021,'检测信用卡轨迹数据1是否泄漏（CC Track Pan）','\\%[Bb][3456][0-9]{3,3}[\\x20\\-]{0,3}[0-9]{4,6}[\\x20\\-]{0,3}[0-9]{2,5}[\\x20\\-]{0,3}[0-9]{0,4}\\^[^\\^]+\\^[0-9]+\\?','从响应体中检测到信用卡轨迹数据1发生泄漏，则阻断（CC_Track_Pan）','OTHER','block',0,1452647413,NULL),(90169,920022,'检测信用卡轨迹数据2是否泄漏（CC Track Pan）','\\;[3456][0-9]{3,3}[\\x20\\-]{0,3}[0-9]{4,6}[\\x20\\-]{0,3}[0-9]{2,5}[\\x20\\-]{0,3}[0-9]{0,4}[=Dd][0-9]+\\?','从响应体中检测到信用卡轨迹数据2发生泄漏，则阻断（CC_Track_Pan）','OTHER','block',0,1452647413,NULL),(90168,920023,'检测信用卡PAN数据是否泄漏（CC Track Pan）','[^0-9][3456][0-9]{3,3}[\\x20\\-]{0,3}[0-9]{4,6}[\\x20\\-]{0,3}[0-9]{2,5}[\\x20\\-]{0,3}[0-9]{0,4}[^0-9]','从响应体中检测到信用卡PAN数据发生泄漏，则阻断（CC_Track_Pan）','OTHER','block',0,1452647413,NULL),(90163,950020,'检测请求数据的参数及参数名称是否包含多个链接（Comment Spam）','(http:\\/.*?){4}','检测请求数据的参数及参数名称，如果一个参数包含太多链接，则阻断（Comment Spam）','OTHER','block',0,1452647413,NULL),(90157,950923,'检测请求数据的参数及参数名称是否在一个POST链接中包含2个请求方法（Comment Spam）','\\[url\\b','如果在一个POST链接中包含2个请求方法，则阻断请求（Comment Spam）','OTHER','block',0,1452647413,NULL),(90165,958297,'检测请求头中User-Agent字段内容（Comment Spam）','^(?:m(?:o(?:zilla\/4\.0\+?\(|vable type)|i(?:crosoft url|ssigua)|j12bot\/v1\.0\.8|sie)|e(?:mail(?:collector| ?siphon)|collector)|(?:blogsearchbot-marti|super happy fu)n|i(?:nternet explorer|sc systems irc)|ja(?:karta commons|va(?:\/| )1\.)|c(?:ore-project\/|herrypicker)|p(?:sycheclone|ussycat|ycurl)|(?:grub crawl|omniexplor)er|a(?:utoemailspider|dwords)|w(?:innie poh|ordpress)|nut(?:scrape/|chcvs)|8484 boston project|user(?:[- ]agent:)?|l(?:ibwww-perl|wp)|di(?:amond|gger)|trackback\/|httpproxy|<sc)','如果请求头中的User-Agent字段内容来自modsecurity_42_comment_spam.data文件中，则判断为垃圾评论内容，返回错误状态码404（Comment Spam）','OTHER','block',0,1452647413,NULL),(90162,981137,'检测是否启用预先黑名单检测（Comment Spam）','IP:PREVIOUS_RBL_CHECK "@eq 1"','如果启用了预先黑名单检测，则跳过黑名单查找规则END_RBL_LOOKUP（Comment Spam）','OTHER','pass',0,1452647413,NULL),(90160,981138,'检测垃圾评论数据来源是否符合预先黑名单（Comment Spam）','REMOTE_ADDR "@rbl sbl-xbl.spamhaus.org"','如果垃圾评论URL来源处于预先的黑名单，则跳过黑名单检测规则END_RBL_CHECK，并记录日志（Comment Spam）','OTHER','pass',0,1452647413,NULL),(90161,981139,'设置默认的预先黑名单参数值（Comment Spam）','ip.previous_rbl_check=1,ip.previous_rbl_check=86400','设置默认的预先黑名单参数值（Comment Spam）','OTHER','pass',0,1452647413,NULL),(90164,981140,'检测是否有黑名单中的请求来源（Comment Spam）','IP:SPAMMER "@eq 1"','如果有黑名单中的请求来源，则设置相关数值（Comment Spam)','OTHER','pass',0,1452647413,NULL),(90158,999010,'检测请求参数或参数名是否有http（Comment Spam）','ARGS|ARGS_NAMES "\bhttp:" ','如果请求参数或参数名中有http，则跳过下一个规则（Comment Spam）','OTHER','block',0,1452647413,NULL),(90159,999011,'初始化CommentSpam处理行为是“继续处理”（Comment Spam）','skipAfter END_COMMENT_SPAM','初始化Comment Spam处理行为是“继续处理”，并跳过Comment Spam检测规则（Comment Spam）','OTHER','block',0,1452647413,NULL), (90102,981020,'检测Apache SSL pinger异常（Common Exceptions）','REQUEST_LINE  "^GET /$" REMOTE_ADDR "^(127\.0\.0\.|\:\:)1$" ','检测Apache SSL pinger异常（Common Exceptions）','OTHER','block',0,1452647413,NULL), (90103,981021,'检测Apache internal dummy connection异常（Common Exceptions）','REQUEST_LINE "^(GET /|OPTIONS \*) HTTP/1.0$" SecRule REMOTE_ADDR "^(127\.0\.0\.|\:\:)1$" REQUEST_HEADERS:User-Agent "^.*\(internal dummy connection\)$" ','检测Apache internal dummy connection异常（Common Exceptions）','OTHER','block',0,1452647413,NULL), (90104,981022,'检测Adobe Flash Player异常（Common Exceptions）','REQUEST_METHOD "@streq POST" REQUEST_HEADERS:User-Agent "@contains Adobe Flash Player" REQUEST_HEADERS:X-Flash-Version ".*" REQUEST_HEADERS:Content-Type "@contains application/x-amf" ','检测Adobe Flash Player异常（Common Exceptions）','OTHER','block',0,1452647413,NULL),(90107,981201,'检测关联成功的攻击(Correlation)','/LEAKAGE /ERRORS ','如果事务集合中以LEAKAGE及ERRORS开头的参数值大于或等于1，则跳过Correlated Attack 规则检测(Correlation)','OTHER','pass',0,1452647413,NULL),(90108,981202,'检测关联尝试的攻击(Correlation)','/AVAILABILITY /APP_NOT_AVAIL ','如果事务集合中以AVAILABILITY及APP_NOT_AVAIL开头的参数值大于或等于1，则跳过Correlated Attack 规则检测(Correlation)','OTHER','pass',0,1452647413,NULL),(90109,981203,'检测入站数据的异常总分数1(Correlation)','TX:INBOUND_ANOMALY_SCORE "@gt 0" ','如果入站数据异常总分数大于0且少于设置的异常分数水平，则跳过Correlated Attack 规则检测(Correlation)','OTHER','pass',0,1452647413,NULL),(90105,981204,'检测入站数据的异常总分数2(Correlation)','TX:INBOUND_ANOMALY_SCORE "@ge %{tx.inbound_anomaly_score_level}" ','如果入站数据异常总分数大于或等于设置的异常分数水平，则跳过Correlated Attack 规则检测(Correlation)','OTHER','pass',0,1452647413,NULL),(90106,981205,'检测出站数据的异常总分数(Correlation)','TX:OUTBOUND_ANOMALY_SCORE "@ge %{tx.outbound_anomaly_score_level}"','如果出站数据异常总分数大于或等于设置的异常分数水平，则跳过Correlated Attack 规则检测(Correlation)','OTHER','pass',0,1452647413,NULL),(90011,960001,'检测请求内容是否违反CSP（内容安全策略）（CSP Enforcement）','({\"csp-report\":.*blocked-uri\":\"(.*?)\".*violated-directive\":\"(.*)\")','检测请求体中的内容来判断是否违反CSP（内容安全策略）（CSP Enforcement）','OTHER','block',0,1452647413,NULL),(90012,960002,'检测请求是否来自FireFox浏览器（仅记录模式）（CSP Enforcement）','?i:mozilla.*firefox','根据请求头的User-Agent字段内容检测到该请求来自FireFox浏览器用户，则设置环境参数来通知Apache用哪个CSP头策略（仅记录模式）（CSP Enforcement）','OTHER','block',0,1452647413,NULL),(90009,960003,'检测请求是否来自FireFox浏览器（CSP Enforcement）','?i:mozilla.*firefox','根据请求头的User-Agent字段内容检测到该请求来自FireFox浏览器用户，则设置环境参数来通知Apache用哪个CSP头策略（CSP Enforcement）','OTHER','block',0,1452647413,NULL),(90010,981142,'检测请求是否为CSP Violation Report Request（CSP Enforcement）','REQUEST_FILENAME "@streq %{tx.csp_report_uri}" ','如果请求为CSP Violation Report Request，则打开功能：forceRequestBodyVariable（CSP Enforcement）','OTHER','block',0,1452647413,NULL),(90110,981143,'检测是否缺少CSRF Token(CSRF Protection)','&ARGS:CSRF_TOKEN "!@eq 1"','如果缺少CSRF Token，则阻断访问(CSRF Protection)','OTHER','block',0,1452647413,NULL),(90112,981144,'检测是否Token是否有效(CSRF Protection)','ARGS:CSRF_TOKEN "!@streq %{SESSION.CSRF_TOKEN}"','如果Token无效，则阻断访问(CSRF Protection)','OTHER','block',0,1452647413,NULL),(90111,981145,'检测是否需要内容注入到CSRF Token(CSRF Protection)','&SESSION:CSRF_TOKEN "@eq 1"','如果需要，则附加相关内容到CSRF Token(CSRF Protection)','OTHER','block',0,1452647413,NULL),(0,981044,'检测是否有IP地址被阻断了(Dos Protection)','IP:DOS_BLOCK "@eq 1"','如果有IP地址被阻断了（Dos Block），则累计阻断数值，并记录日志(Dos Protection)','OTHER','block',1,1452647413,NULL),(0,981045,'检测是否有IP地址被阻断了,无日志(Dos Protection)','IP:DOS_BLOCK "@eq 1"','如果有IP地址被阻断了（Dos Block），则累计阻断数值，无日志记录(Dos Protection)','OTHER','block',1,1452647413,NULL),(0,981046,'检测当前IP地址是否因为高请求而被阻断(Dos Protection)','IP:DOS_BLOCK "@eq 1"','如果当前IP地址因为高请求而被阻断，则跳过Dos Protection规则检测(Dos Protection)','OTHER','block',1,1452647413,NULL),(0,981048,'检测Dos攻击请求数是否大于0(Dos Protection)','IP:DOS_COUNTER "@gt 0"','检测Dos攻击请求数是否大于0(Dos Protection)','OTHER','block',1,1452647413,NULL),(0,981049,'检测Dos攻击请求数是否大于或等于用户设置的请求数(Dos Protection)','IP:DOS_COUNTER "@ge %{tx.dos_counter_threshold}"','如果Dos攻击请求数大于或等于用户设置的请求数，则设置burst数值(Dos Protection)','OTHER','block',1,1452647413,NULL),(3016,950000,'SESSION加固(OWASP TOP 10)','jsessionid aspsessionid asp.net_sessionid phpsession phpsessid weblogicsession session_id session-id cfid cftoken cfsid jservsession jwsession','检测可能的SESSION加固攻击，当来源为空时通过在http请求中检测jsessionid aspsessionid asp.net_sessionid phpsession phpsessid weblogicsession session_id session-id cfid cftoken cfsid jservsession jwsession等来实现','GENERIC','block',0,1452647413,NULL),(3018,950002,'系统命令访问(OWASP TOP 10)','\b(?:(?:n(?:map|et|c)|w(?:guest|sh)|telnet|rcmd|ftp)\.exe\b|cmd(?:(?:32)?\.exe\b|\b\W*?\/c))','该规则检测以下可能的系统命令访问：nmap net nc telnet ftp cmd32.exe','GENERIC','block',0,1452647413,NULL),(3015,950003,'SESSION加固(OWASP TOP 10)','jsessionid aspsessionid asp.net_sessionid phpsession phpsessid weblogicsession session_id session-id cfid cftoken cfsid jservsession jwsession','检测可能的SESSION加固攻击，当来源为外站时通过在http请求中检测jsessionid aspsessionid asp.net_sessionid phpsession phpsessid weblogicsession session_id session-id cfid cftoken cfsid jservsession jwsession等来实现','GENERIC','block',0,1452647413,NULL),(3017,950005,'远程文件访问(OWASP TOP 10)','(?:\b(?:\.(?:ht(?:access|passwd|group)|www_?acl)|global\.asa|httpd\.conf|boot\.ini)\b|\/etc\/)','该规则检测COOKIE或url参数中的可能文件注入，主要通过以下关键词检测实现：httpd.conf boot.ini /etc/ .htaccess .htpasswd .htgroup','GENERIC','block',0,1452647413,NULL),(3019,950006,'系统命令注入(OWASP TOP 10)','(?:\b(?:(?:n(?:et(?:\b\W+?\blocalgroup|\.exe)|(?:map|c)\.exe)|t(?:racer(?:oute|t)|elnet\.exe|clsh8?|ftp)|(?:w(?:guest|sh)|rcmd|ftp)\.exe|echo\b\W*?\by+)\b|c(?:md(?:(?:\.exe|32)\b|\b\W*?\/c)|d(?:\b\W*?[\\/]|\W*?\.\.)|hmod.{0,40}?\+.{0,3}x))|[\;\|\`]\W*?\b(','该规则检测可能的系统命令注入：net.ext nmap.exe nc.exe traceroute tracert telnet.exe tclsh tftp ftp.exe echo cmd cd chmod等','GENERIC','block',0,1452647413,NULL),(3002,950008,'Coldfusion注入(OWASP TOP 10)','\bcf(?:usion_(?:d(?:bconnections_flush|ecrypt)|set(?:tings_refresh|odbcini)|getodbc(?:dsn|ini)|verifymail|encrypt)|_(?:(?:iscoldfusiondatasourc|getdatasourceusernam)e|setdatasource(?:password|username))|newinternal(?:adminsecurit|registr)y|admin_registry_','该规则会检测用户输入中是否会出现一些未定义的Coldfusion管理函数名称，通过阻断这样的输入，来阻断可能的Coldfusion注入攻击','GENERIC','block',0,1452647413,NULL),(3014,950009,'SESSION加固(OWASP TOP 10)','(?i)(?:\.cookie\b.*?;\W*?(?:expires|domain)\W*?=|\bhttp-equiv\W+set-cookie\b)','检测可能的SESSION加固攻击,通过在http请求中检测cookie;expires=;domain=;set cookie;http-equiv等来实现','GENERIC','block',0,1452647413,NULL),(3003,950010,'LDAP注入(OWASP TOP 10)','(?:\((?:\W*?(?:objectc(?:ategory|lass)|homedirectory|[gu]idnumber|cn)\b\W*?=|[^\w\x80-\xFF]*?[\!\&\|][^\w\x80-\xFF]*?\()|\)[^\w\x80-\xFF]*?\([^\w\x80-\xFF]*?[\!\&\|])','该规则通过查找常用的LDAP数据结构内容来达到防止LDAP注入,如：objectcategory = homedirectory =等','GENERIC','block',0,1452647413,NULL),(3004,950011,'SSI注入(OWASP TOP 10)','<!--\W*?#\W*?(?:e(?:cho|xec)|printenv|include|cmd)','该规则检测常见的服务器站点包含格式的数据。如：<!--#echo <!--#exec <!--#printenv <!--#include <!--#cmd','GENERIC','block',0,1452647413,NULL),(3007,950012,'http请求走私(OWASP TOP 10)',',','该规则探测在http头Content-Length, Transfer-Encoding中的逗号(,),比如：Content-Length: 0, 44的意思就是有两个Content-Length,一个值是0，一个是44，apache处理这样的头就好像处理多个Cookie一样','GENERIC','block',0,1452647413,NULL),(3005,950018,'UPDF XSS','http:\/\/[\w\.]+?\/.*?\.pdf\b[^\x0d\x0a]*#','该规则会寻找包含在QUERY_STRING中的＃片段内容','GENERIC','block',0,1452647413,NULL),(3006,950019,'邮件命令注入','[\n\r]\s*\b(?:to|b?cc)\b\s*:.*?\@','该规则会检测用户输入数据中的邮件命令注入,如：to:111@bluedon.cn 或 cc:111@bluedon.cn 或 bcc:111@bluedon.cn等','GENERIC','block',0,1452647413,NULL),(3010,950117,'URL中有IP地址','^(?i)(?:ht|f)tps?:\/\/(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})','该规则检测URL中是否含有ip地址，来检测可能的RFI攻击','GENERIC','block',0,1452647413,NULL),(3011,950118,'PHP的Include函数','(?i:(\binclude\s*\([^)]*|mosConfig_absolute_path|_CONF\[path\]|_SERVER\[DOCUMENT_ROOT\]|GALLERY_BASEDIR|path\[docroot\]|appserv_root|config\[root_dir\])=(ht|f)tps?:\/\/)','该规则检测在http的query_string或请求体中是否有php的include()函数等,来检测可能的RFI攻击','GENERIC','block',0,1452647413,NULL),(3012,950119,'以问号（？）结束RFI数据','^(?i)(?:ft|htt)ps?(.*?)\?+$','该规则检测在http请求中，以?结束的RFI攻击数据，如：http://test.com?','GENERIC','block',0,1452647413,NULL),(3013,950120,'RFI的主机名和web服务器的不一致','^(?:ht|f)tps?://(.*)$','当http请求中存在任何url格式的内容时，并且其中的主机和web服务器的不一致时，有可能存在RFI攻击。如http请求内容中有如下格式的东西：http://other.com','GENERIC','block',0,1452647413,NULL),(3001,950907,'操作系统命令注入(OWASP TOP 10)','(?i:(?:[\;\|\`]\W*?\bcc|\b(wget|curl))\b|\/cc(?:[\'\"\|\;\`\-\s]|$))','该规则会查找一些企图访问操作系统命令的尝试，比如：curl、wget、cc等，这些命令经常被攻击者用来从受害者网站向外发出网络链接来下载或编译安装恶意工具程序','GENERIC','block',0,1452647413,NULL),(3008,950910,'http响应分片(逗号的检测)','[\n\r](?:content-(type|length)|set-cookie|location):','该规则在http头中探测头中或cookie中的字段内容是否有：content-type: content-length: set-cookie: location:等，来防止用户来将自己输入的内容直接在应答中返回，达到http响应分片的目的','GENERIC','block',0,1452647413,NULL),(3009,950911,'http响应分片(可能出现的分片内容检测)','(?:\bhttp\/(?:0\.9|1\.[01])|<(?:html|meta)\b)','该规则检测在http头或cookie中的字段内容是否含有：http/0.9 http/1.0 http/1.1 或者 <html <meta等，来检测可能的http响应分片攻击','GENERIC','block',0,1452647413,NULL),(3021,958976,'在PHP中注入其他PHP代码(OWASP TOP 10)','(?i)(?:\b(?:f(?:tp_(?:nb_)?f?(?:ge|pu)t|get(?:s?s|c)|scanf|write|open|read)|gz(?:(?:encod|writ)e|compress|open|read)|s(?:ession_start|candir)|read(?:(?:gz)?file|dir)|move_uploaded_file|(?:proc_|bz)open|call_user_func)|\$_(?:(?:pos|ge)t|session))\b','该规则检测尝试在http请求中输入php代码尝试注入到php中：$_post $_get $_session gzopen gzcompress session_start scandir','GENERIC','block',0,1452647413,NULL),(3022,958977,'PHP注入攻击(OWASP TOP 10)','allow_url_include= safe_mode= suhosin.simulation= disable_functions= open_basedir= auto_prepend_file= php://input','该规则在http请求数据中检测以下关键词：allow_url_include= safe_mode= suhosin.simulation= disable_functions= open_basedir= auto_prepend_file= php://input','GENERIC','block',0,1452647413,NULL),(3020,959151,'在PHP中注入XML的攻击(OWASP TOP 10)','<\?(?!xml)','该规则检测尝试在php代码中注入xml代码的尝试：<?xml','GENERIC','block',0,1452647413,NULL),(3023,960024,'启发式检测(非单词字符检测）','\W{4,}','该规则在http请求的参数中检测连续等于或超过4次的非单词字符的出现','GENERIC','block',0,1452647413,NULL),(90156,981133,'检测请求内容是否符合通用攻击规则（Generic Attacks）','REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@pmFromFile modsecurity_40_generic_attacks.data" ','如果请求内容符合通用攻击规则，则累计pm_score数值（Generic Attacks）','GENERIC','block',0,1452647413,NULL),(90155,981134,'检测参数pm_score值是否为0（Generic Attacks)','TX:PM_SCORE "@eq 0"','如果参数pm_score值为0，则跳过END_PM_CHECK规则，无日志记录（Generic Attacks)','GENERIC','block',0,1452647413,NULL),(90006,900044,'检测anomaly score数值(Header Tagging)','TX:ANOMALY_SCORE "@eq 0"','如果anomaly score数值为0，则跳过请求头标识规则(Header Tagging)','OTHER','block',0,1452647413,NULL),(90005,900045,'检测请求头部分是否匹配发出异常事件规则(Header Tagging)','TX:/^\d/ "." ','检测请求头部分是否匹配发出异常事件规则，若符合规则，则记录相应的异常记录值(Header Tagging)','OTHER','block',0,1452647413,NULL),(90166,900032,'检测http请求参数是否发生参数污染(Http Parameter Pollution)','ARGS "^"','检测http请求参数是否发生参数污染(Http Parameter Pollution)','OTHER','block',0,1452647413,NULL),(90088,960010,'检测请求方法及请求内容类型来判断是否符合http策略（Http Policy）','REQUEST_METHOD "!^(?:GET|HEAD|PROPFIND|OPTIONS)$"  REQUEST_HEADERS:Content-Type "^([^;\s]+)"','如果请求方法及请求内容类型来判断不符合http策略，则阻断访问（Http Policy）','OTHER','block',0,1452647413,NULL),(90086,960032,'检测请求方法是否符合http策略（Http Policy）','!@within %{tx.allowed_methods}','如果请求方法在http策略中受限，则阻断访问（Http Policy）','OTHER','block',0,1452647413,NULL),(90089,960034,'检测http版本是否符合http策略（Http Policy）','!@within %{tx.allowed_http_versions}','如果请求数据的http协议版本在http策略中受限，则阻断访问（Http Policy）','OTHER','block',0,1452647413,NULL),(90090,960035,'检测请求数据中的文件扩展名是否符合http策略（Http Policy）','\.(.*)$" "chain,capture,setvar:tx.extension=.%{tx.1}','如果请求数据中URL的文件扩展名在http策略受限，则阻断访问（Http Policy）','OTHER','block',0,1452647413,NULL),(90087,960038,'检测请求数据中的http头部是否符合http策略（Http Policy）','^(.*)$','如果请求数据中http头部在http策略中受限，则阻断访问（Http Policy）','OTHER','block',0,1452647413,NULL),(90056,900040,'检测请求方法是GET或HEAD的请求是否有参数及以文件扩展名结束(Ignore Static)','REQUEST_METHOD "^(?:GET|HEAD)$"','如果请求方式是GET或HEAD，并且该请求没有带参数同时是以静态内容文件扩展名结尾的，则跳过该请求的检测(Ignore Static)','OTHER','block',0,1452647413,NULL),(90055,900041,'初始化动作为允许访问，跳过静态内容检测规则(Ignore Static)','skipAfter END_STATIC_CONTENT_CHECK','初始化动作为允许访问，跳过静态内容检测规则(Ignore Static','OTHER','block',0,1452647413,NULL),(90058,900042,'检测请求文件名（以jpeg、png、gif及ico扩展名结尾的图片文件）(Ignore Static)','REQUEST_FILENAME "\.(?:(?:jpe?|pn)g|gif|ico)$"','如果请求文件名是以jpeg、png、gif及ico扩展名结尾的图片文件，则允许访问(Ignore Static)','OTHER','block',0,1452647413,NULL),(90057,900043,'检测请求文件名（以doc、pdf、txt及xls扩展名结尾的文本文件）(Ignore Static)','REQUEST_FILENAME "\.(?:doc|pdf|txt|xls)$"','如果请求文件名是以doc、pdf、txt及xls扩展名结尾的文本文件，则允许访问并设置相关参数(Ignore Static)','OTHER','block',0,1452647413,NULL),(90054,999005,'检测请求文件类型是否是html（Ignore Static）','REQUEST_FILENAME "\.(?:(?:cs|j)s|html?)$"','如果匹配规则，则说明是html文件（Ignore Static）','OTHER','block',0,1452647413,NULL),(90053,999006,'检测请求文件类型是否是Media（Ignore Static）','REQUEST_FILENAME "\.(?:mp(?:e?g|3)|avi|flv|swf|wma)$"','如果匹配规则，则说明是Media文件（Ignore Static）','OTHER','block',0,1452647413,NULL),(90122,981175,'检测入站数据是否有以开源漏洞数据库（OSVDB）中标记的资源为目标的攻击（Inbound Blocking）','TX:ANOMALY_SCORE “@gt 0”  RESOURCE:OSVDB_VULNERABLE “@eq 1” TX:ANOMALY_SCORE_BLOCKING “@streq on” ','如果有入站攻击，则拒绝访问，并记录日志（Inbound Blocking）','OTHER','deny',0,1452647413,NULL), (90121,981176,'检测入站数据异常分数是否溢出（Inbound Blocking）','TX:ANOMALY_SCORE "@gt 0"','如果异常分数溢出，则拒绝访问，并记录日志（Inbound Blocking）','OTHER','block',0,1452647413,NULL),(90153,900036,'检测异常分数是否大于0（IP Forensics)','TX:ANOMALY_SCORE "@gt 0"','如果异常分数大于0，则执行gather_ip_data.lua脚本，进行IP查找检测（IP Forensics)','OTHER','block',0,1452647413,NULL),(90154,900037,'检测hostname（IP Forensics）','TX:HOSTNAME ".*"','检测hostname，并记录日志（IP Forensics）','OTHER','block',0,1452647413,NULL),(90151,900038,'检测异常分数是否大于0（IP Forensics)','TX:ANOMALY_SCORE "@gt 0"','如果异常分数大于0，则记录日志，日志内容为ip的hostname（IP Forensics)','OTHER','block',0,1452647413,NULL),(90152,900039,'检测事务处理异常分数是否大于0（IP Forensics)','TX:ANOMALY_SCORE "@gt 0"','如果异常分数大于0，则记录日志，日志内容为GeoIP数据（IP Forensics)','OTHER','block',0,1452647413,NULL),(6016,970002,'统计页面信息泄漏','\b(?:Th(?:is (?:summary was generated by.{0,100}?(?:w(?:ebcruncher|wwstat)|analog|Jware)|analysis was produced by.{0,100}?(?:calamaris|EasyStat|analog)|report was generated by WebLog)|ese statistics were produced by (?:getstats|PeLAB))|[gG]enerated by.{0,','该规则检测服务器响应页面中是否会泄漏统计页面中包含一些信息。如：This summary was generated by ***(wwwstat)','LEAKAGE','block',1,1395124100,NULL),(6017,970003,'数据库错误信息泄漏(OWASP TOP 10)','(?:\b(?:(?:s(?:elect list because it is not contained in (?:an aggregate function and there is no|either an aggregate function or the) GROUP BY clause|upplied argument is not a valid (?:PostgreSQL result|O(?:racle|DBC)|M(?:S |y)SQL))|S(?:yntax error conve','该规则检测服务器响应页面中是否会泄漏数据库的一些错误信息。如：SQL Server does not exist or access denied,PostgreSQL *** ERROR','LEAKAGE','block',1,1395124100,NULL), (6018,970004,'IIS错误信息泄漏(OWASP TOP 10)','(?:\\b(?:A(?:DODB\\.Command\\b.{0,100}?\\b(?:Application uses a value of the wrong type for the current operation\\b|error\')| trappable error occurred in an external object\\. The script cannot continue running\\b)|Microsoft VBScript (?:compilation (?:\\(0x8|error)|runtime (?:Error|\\(0x8))\\b|Object required: \'|error \'800)|<b>Version Information:<\\/b>(?:&nbsp;|\\s)(?:Microsoft \\.NET Framework|ASP\\.NET) Version:|>error \'ASP\\b|An Error Has Occurred|>Syntax error in string in query expression|\\/[Ee]rror[Mm]essage\\.aspx?\\?[Ee]rror\\b)','该规则检测服务器响应页面，看在IIS错误信息页面中是否会泄漏信息。如泄漏.net版本信息：Microsoft .NET Framework Version:***','LEAKAGE','block',1,1395124100,NULL),(6001,970007,'Zope web服务器信息泄漏(OWASP TOP 10)','<h2>Site Error<\/h2>.{0,20}<p>An error was encountered while publishing this resource\.','该规则检测服务器响应页面是否泄漏Zope服务器的相关信息，如：Site Error   An error was encountered while publishing this resource ***','LEAKAGE','block',1,1395124100,NULL),(6002,970008,'Cold Fusion信息泄漏(OWASP TOP 10)','\bThe error occurred in\b.{0,100}: line\b.{0,1000}\bColdFusion\b.*?\bStack Trace \(click to expand\)','该规则检测服务器响应页面是否会泄漏Cold Fusion的相关信息，如：The error occurred in *** : line *** ColdFusion','LEAKAGE','block',1,1395124100,NULL), (6003,970009,'PHP信息泄漏(OWASP TOP 10)','<b>Warning<\\/b>.{0,100}?:.{0,1000}?\\bon line\\b','该规则检测服务器响应页面是否会泄漏PHP的相关信息，如：Warning *** :on line','LEAKAGE','block',1,1395124100,NULL),(6004,970010,'ISA服务器信息泄漏(OWASP TOP 10)','\\b403 Forbidden\\b.*?\\bInternet Security and Acceleration Server\\b\\','该规则检测服务器响应页面是否会泄漏ISA服务器相关的信息，如：403 Forbidden *** Internet Security and Acceleration Server','LEAKAGE','block',1,1395124100,NULL),(6012,970011,'文件或目录名信息泄漏(OWASP TOP 10)','href\\s?=[\\s\\\"\\\']*[A-Za-z]\\:\\x5c([^\\\"\\\']+)','该规则检测服务器响应页面内容是否泄漏文件或目录信息。如：herf = 文件路径','LEAKAGE','block',1,1395124100,NULL),(6005,970012,'微软Office文档属性信息泄漏(OWASP TOP 10)','<o:documentproperties>','该规则检测服务器响应页面是否泄漏微软Office文档的属性信息，如：通过<o:documentproperties>泄漏','LEAKAGE','block',1,1395124100,NULL), (6020,970013,'目录列表泄漏(OWASP TOP 10)','(?:<(?:TITLE>Index of.*?<H|title>Index of.*?<h)1>Index of|>\\[To Parent Directory\\]<\\/[Aa]><br>)','该规则检测服务器响应页面中是否泄漏服务端的目录列表。一般目录列表页面可能包含以下信息：[To Parent Directory], 标题一般是Index of等','LEAKAGE','block',1,1395124100,NULL), (6013,970014,'ASP/JSP源代码泄漏(OWASP TOP 10)','(?:\\b(?:(?:s(?:erver\\.(?:(?:(?:htm|ur)lencod|execut)e|createobject|mappath)|cripting\\.filesystemobject)|(?:response\\.(?:binary)?writ|vbscript\\.encod)e|wscript\\.(?:network|shell))\\b|javax\\.servlet)|\\.(?:(?:(?:createtex|ge)t|loadfrom)file|addheader)\\b|<jsp:)\\','该规则检测服务器响应页面内容是否有JSP/ASP源代码泄漏。如：server.htmlencode,server.execute,<jsp:***等','LEAKAGE','block',1,1395124100,NULL),(6014,970015,'PHP源代码泄漏(OWASP TOP 10)','(?:\\b(?:f(?:tp_(?:nb_)?f?(?:ge|pu)t|get(?:s?s|c)|scanf|write|open|read)|gz(?:(?:encod|writ)e|compress|open|read)|s(?:ession_start|candir)|read(?:(?:gz)?file|dir)|move_uploaded_file|(?:proc_|bz)open|call_user_func)|\\$_(?:(?:pos|ge)t|session))\\b','该规则检测服务器响应页面内容是否有PHP源代码泄漏。如：fgets ***,fget ***, readdir ***,$_post, $_get, $_session','LEAKAGE','block',1,1395124100,NULL),(6007,970016,'Cold Fusion源代码泄漏(OWASP TOP 10)','<cf','该规则检测服务器响应页面内容是否有Cold Fusion的源代码泄漏，如：<cf***','LEAKAGE','block',1,1395124100,NULL),(6008,970018,'IIS缺省安装目录泄漏','[a-z]:\\\\\\\\inetpub\\b','该规则检测服务器响应页面内容是否泄漏了IIS安装在缺省安装目录，如：c:\\inetpub','LEAKAGE','block',1,1395124100,NULL), (6011,970021,'WebLogic信息泄漏','<title>JSP compile error<\\/title>','该规则检测当服务器返回状态码为500的时候，响应页面是否泄漏WebLogic的信息，如：<title>JSP compile error</title>','LEAKAGE','block',1,1395124100,NULL),(6010,970118,'Web应用程序不可用信息泄漏(OWASP TOP 10)','(?:Microsoft OLE DB Provider for SQL Server(?:<\\/font>.{1,20}?error \'800(?:04005|40e31)\'.{1,40}?Timeout expired| \\(0x80040e31\\)<br>Timeout expired<br>)|<h1>internal server error<\\/h1>.*?<h2>part of the server has crashed or it has a configuration error\\.<\\/h2>|cannot connect to the server: timed out)','该规则检测服务器响应页面内容是否泄漏了相关的web应用程序信息。如：Microsoft OLE DB Provider for SQL Server (0x80040e31) Timeout expired','LEAKAGE','block',1,1395124100,NULL), (6009,970901,'Web应用程序不可用，5XX错误(OWASP TOP 10)','^5\\d{2}$','该规则检测服务器返回的状态码，如果是5XX错误码，则表示web应用程序不可用，该规则将阻止5XX错误。','LEAKAGE','block',1,1395124100,NULL), (6015,970902,'xml中的PHP源代码泄漏(OWASP TOP 10)','<\\?(?!xml)','该规则检测服务器响应页面中的xml内容中是否有PHP源代码泄漏。','LEAKAGE','block',1,1395124100,NULL),(6006,970903,'ASP/JSP源代码泄漏(OWASP TOP 10)','\\<\\%','该规则检测服务器响应页面内容是否有ASP/JSP的源代码泄漏，如：<%***','LEAKAGE','block',1,1395124100,NULL),(6019,970904,'IIS的404错误页面泄漏信息(OWASP TOP 10)','\\bServer Error in.{0,50}?\\bApplication\\b','该规则检测IIS的404错误页面，看是否泄漏信息。如泄漏web应用程序相关的信息：Server Error in *** Application','LEAKAGE','block',1,1395124100,NULL),(90065,910006,'检测请求头中User-Agent的内容(Google爬虫)（Marketing)','(?:(?:gsa-crawler \(enterprise; s4-e9lj2b82fjjaa; me\@mycompany\.com|adsbot-google \(\+http:\/\/www\.google\.com\/adsbot\.html)\)|\b(?:google(?:-sitemaps|bot)|mediapartners-google)\b)','如果请求头中User-Agent的内容符合google爬虫行为，则阻断（Marketing）','OTHER','block',0,1452647413,NULL),(90066,910007,'检测请求头中User-Agent的内容(Yahoo爬虫)（Marketing)','\byahoo(?:-(?:mmcrawler|blogs)|! slurp)\b','如果请求头中User-Agent的内容符合yahoo爬虫行为，则阻断（Marketing）','OTHER','block',0,1452647413,NULL),(90067,910008,'检测请求头中User-Agent的内容(Msn爬虫)（Marketing)','msn(?:bot|ptc)','如果请求头中User-Agent的内容符合Msn爬虫行为，则阻断（Marketing）','OTHER','block',0,1452647413,NULL),(90046,981000,'检测响应体是否有恶意的Iframe标识注入1（OutBound）',' RESPONSE_BODY "<\W*iframe[^>]+?\b(?:width|height)\b\W*?"','如果响应体含有恶意的Iframe标识注入，则阻断访问1（OutBound）','OTHER','block',0,1452647413,NULL),(90047,981001,'检测响应体是否有恶意的Iframe标识注入2（OutBound）','RESPONSE_BODY "<\W*iframe[^>]+?\bstyle\W*? "','如果响应体含有恶意的Iframe标识注入，则阻断访问2（OutBound）','OTHER','block',0,1452647413,NULL),(90045,981003,'检测响应体是否有恶意的Iframe标识注入3（OutBound）','RESPONSE_BODY "(?i:<\s*IFRAME\s*?[^>]*?src=\"javascript:)"','如果响应体含有恶意的Iframe标识注入，则阻断访问3（OutBound）','OTHER','block',0,1452647413,NULL),(90043,981004,'检测响应体是否有恶意JS注入1（OutBound）','RESPONSE_BODY "(?i)(String\.fromCharCode\(.*?){4,}"','如果响应体含有恶意的Javascript注入，则阻断访问1（OutBound）','OTHER','block',0,1452647413,NULL),(90044,981005,'检测响应体是否有恶意JS注入2（OutBound）','RESPONSE_BODY "(?i)(eval\(.{0,15}unescape\()"','如果响应体含有恶意的Javascript注入，则阻断访问2（OutBound）','OTHER','block',0,1452647413,NULL),(90041,981006,'检测响应体是否有恶意JS注入3（OutBound）','RESPONSE_BODY "(?i)(var[^=]+=\s*unescape\s*;)"','如果响应体含有恶意的Javascript注入，则阻断访问3（OutBound）','OTHER','block',0,1452647413,NULL),(90042,981007,'检测响应体是否有恶意JS注入4（OutBound）','RESPONSE_BODY "(?i:%u0c0c%u0c0c|%u9090%u9090|%u4141%u4141)"','如果响应体含有恶意的Javascript注入，则阻断访问4（OutBound）','OTHER','block',0,1452647413,NULL),(90039,981177,'检测出站数据是否有Iframe注入攻击（OutBound）','RESPONSE_BODY "!@pm iframe"','检测响应体数据是否含有iframe短语，如果没有，则跳过Iframe规则检测（OutBound）','OTHER','block',0,1452647413,NULL),(90040,981178,'检测出站数据是否有modsecurity_50_outbound.data文件中列出的短语（OutBound）',' !@pmFromFile modsecurity_50_outbound.data','如果响应体数据没有modsecurity_50_outbound.data文件中列出的短语，则跳过OutBound规则检测(OutBound)','OTHER','block',0,1452647413,NULL),(90170,981200,'检测输出数据的异常分数及异常分数阻断标志参数(Outbound Blocking)','TX:OUTBOUND_ANOMALY_SCORE "@ge %{tx.outbound_anomaly_score_level}"   TX:ANOMALY_SCORE_BLOCKING "@streq on" ','如果输出数据的异常分数大于或等于设定的异常分数水平并且开启了异常分数阻断标志，则拒绝访问，并记录日志(Outbound Blocking)','OTHER','pass',0,1452647413,NULL),(30000,301200,'Accept溢出','NULL','NULL','OVERFLOW','block',1,1395124100,NULL),(30001,301201,'Accept-Charset溢出','NULL','NULL','OVERFLOW','block',1,1395124100,NULL),(30002,301202,'Accept-Encoding溢出','NULL','NULL','OVERFLOW','block',1,1395124100,NULL),(30003,301203,'Cookie溢出','NULL','NULL','OVERFLOW','block',1,1395124100,NULL),(30004,301204,'Post溢出','NULL','NULL','OVERFLOW','block',1,1395124100,NULL),(30005,301205,'URI溢出','NULL','NULL','OVERFLOW','block',1,1395124100,NULL),(30006,301206,'Host溢出','NULL','NULL','OVERFLOW','block',1,1395124100,NULL),(30007,301207,'Referer溢出','NULL','NULL','OVERFLOW','block',1,1395124100,NULL),(30008,301208,'Authorization溢出','NULL','NULL','OVERFLOW','block',1,1395124100,NULL),(30009,301209,'Poxy-Authorization溢出','NULL','NULL','OVERFLOW','block',1,1395124100,NULL),(30010,301210,'User-Agent溢出','NULL','NULL','OVERFLOW','block',1,1395124100,NULL),(4016,950107,'URI的URL编码校验','\\%((?!$|\\W)|[0-9a-fA-F]{2}|u[0-9a-fA-F]{4})','该规则检测URI的内容是否有非URL编码的内容出现，如果有则认为可能有攻击','PROTOCOL','block',1,1395124100,NULL), (4017,950109,'QUERY_STRING中的ARGS的URL编码校验','\\%((?!$|\\W)|[0-9a-fA-F]{2}|u[0-9a-fA-F]{4})','该规则检测请求串中的参数的内容，是否都是有效的URL编码，否则阻断','PROTOCOL','block',1,1395124100,NULL),(4020,950116,'禁止unicode全宽字符编码','\\%u[fF]{2}[0-9a-fA-F]{2}','该规则检测用户URI和请求体中是否有unicode全宽字符编码，如：%uffae，有的将被认为是可能的攻击，将阻断','PROTOCOL','block',1,1395124100,NULL),(4019,950801,'UTF8编码校验','@validateUtf8Encoding','当用户的网站是utf8编码的时候，该规则校验用户上传的信息是否符合Utf8编码','PROTOCOL','block',1,1395124100,NULL),(4013,958230,'Range、Request-Range内容后字节要大于前字节','(\\d+)\\-(\\d+)\\,','该规则检测Range或Request-Range的内容是否接受字节大于起始字节,如：Range:bytes=455-255,这样的内容将会被阻断','PROTOCOL','block',1,1395124100,NULL),(4014,958231,'Range、Request-Range定义子字节范围过多','^bytes=(\\d+)?\\-(\\d+)?\\,\\s?(\\d+)?\\-(\\d+)?\\,\\s?(\\d+)?\\-(\\d+)?\\,\\s?(\\d+)?\\-(\\d+)?\\,\\s?(\\d+)?\\-(\\d+)?\\,','该规则检测Range或Request-Range中定义的以逗号分割的子字节范围是否过多,如：Range:bytes=500-600,601-999,一般子范围不超过5个','PROTOCOL','block',1,1395124100,NULL),(4012,958291,'Range的字节范围不能从0开始','@beginsWith bytes=0-','该规则探测HTTP请求头中的Range字段的内容是否是以0开始的，比如Range:bytes=0-，一般浏览器都不会这么做，但很多机器人或爬虫程序可能会违背RFC这么干','PROTOCOL','block',1,1395124100,NULL),(4015,958295,'Connection中不能有冲突的内容','\\b(keep-alive|close),\\s?(keep-alive|close)\\b','该规则检测Connection中是的内容是否冲突，如：keep-alive,close并存将被阻断','PROTOCOL','block',1,1395124100,NULL),(90115,960000,'多样化数据企图绕过检测(Protocol Violations)','FILES_NAMES|FILES "[\'\\\";=]"','检测文件或文件名是否包含有meta-characters，若有该类字符，则阻断访问(Protocol Violations)','PROTOCOL','block',0,1452647413,NULL),(4506,960006,'请求头中的User-Agent的内容为空','^$','该规则检测http请求头中的User-Agent字段的内容是否为空，为空则阻断','PROTOCOL','block',1,1395124100,NULL),(4502,960007,'请求头中Host内容为空','^$','该规则检测请求头中Host的内容是否未空，为空则阻断','PROTOCOL','block',1,1395124100,NULL),(4501,960008,'请求头中缺少Host(OWASP TOP 10)','@eq 0','该规则检测用户上传的请求头中是否缺少Host字段，如果缺少，则阻断','PROTOCOL','block',1,1395124100,NULL),(4505,960009,'请求头中缺少User-Agent头(OWASP TOP 10)','@eq 0','该规则检测http请求头中是否缺少User-Agent，如缺少将阻断','PROTOCOL','block',0,1395124100,NULL),(4007,960011,'Get或Head请求不能有请求体','^(?:GET|HEAD)$','按标准规范Get或Head请求可以有请求体，但在实际环境中很少使用这个特性，因为黑客可能利用该特性发送一些请求体到一些不知情的web应用程序，来达到攻击目的','PROTOCOL','block',0,1395124100,NULL),(4008,960012,'Post请求都要求有Content-Length字段','^POST$','该规则检测到如果请求是Post，则要求在请求头中必须有Content-Length字段的内容','PROTOCOL','block',0,1395124100,NULL),(4503,960015,'请求头中缺少Accept(OWASP TOP 10)','@eq 0','该规则检测用户上传的请求头，看是否缺少Accetp头，当动作为非OPTIONS，而又缺少Accept头时将阻断','PROTOCOL','block',0,1395124100,NULL),(4006,960016,'Content-Length的内容只能数字','!^\d+$','该规则检测http请求头中Content-Length字段的内容是否是数字，按RFC的要求必须是数字','PROTOCOL','block',0,1395124100,NULL),(4508,960017,'Host的内容是IP地址(OWASP TOP 10)','^[\d.:]+$','该规则检测Host的内容是否是数字和.组成的IP地址，或者再带上端口号，如：1.1.1.1：80,是则阻断，因为很多网络蠕虫或自动化程序都是通过IP段扫描来传播的','PROTOCOL','block',0,1395124100,NULL),(4022,960018,'当开通严格限制后，将限制字符范围32-126','@validateByteRange 32-126','如果开通了严格限制模式，该规则检测用户的请求数据,包括请求参数、内容或请求头内容等必须是32-126内的可见字符','PROTOCOL','block',1,1395124100,NULL),(4011,960020,'HTTP/1.1要求Pragma和Cache-Control必须成对出现','@eq 1','RFC规范要求HTTP/1.1中当有Pragma字段的时候必须也有Cache-Control字段，否则本规则将阻断','PROTOCOL','block',0,1395124100,NULL),(4504,960021,'请求头中的Accept的内容为空','^$','该规则检测当用户Http请求动作为非OPTIONS时，请求头中的Accetp的内容是否为空，为空则阻断','PROTOCOL','block',1,1395124100,NULL),(4010,960022,'Expect只是HTTP/1.1的一个属性','@contains 100-continue','Expect只是HTTP/1.1的属性，所以该规则检测请求的http协议版本，如果是HTTP/1.0，但请求头中有Expect字段，该规则将阻断','PROTOCOL','block',1,1395124100,NULL),(4021,960901,'限制请求的参数或内容必须为可打印字符1-255','@validateByteRange 1-255','该规则检测用户的请求数据,包括请求参数、内容或请求头内容等必须是1-255内的可见字符','PROTOCOL','block',1,1395124100,NULL),(4009,960902,'拒绝请求字段Content-Encoding的内容为Identity','^Identity$','identity编码只能用在Accept-Encoding头中，而不能用在Content-Encoding中,如果使用了，该规则将阻断','PROTOCOL','block',1,1395124100,NULL),(4507,960904,'有请求内容的请求头中缺少Content-Type','@eq 0','该规则检测当请求头中的Content-Length存在，并且内容不为零的时候，是否在请求头中有Content-Type字段，如没，则web应用程序不知道怎么解析请求数据，阻断','PROTOCOL','block',1,1395124100,NULL),(4001,960911,'URI请求格式验证','!^(?i:(?:[a-z]{3,10}\\s+(?:\\w{3,7}?://[\\w\\-\\./]*(?::\\d+)?)?/[^?#]*(?:\\?[^#\\s]*)?(?:#[\\S]*)?|connect (?:\\d{1,3}\\.){3}\\d{1,3}\\.?(?::\\d+)?|options \\*)\\s+[\\w\\./]+|get /[^?#]*(?:\\?[^#\\s]*)?(?:#[\\S]*)?)$','该规则规定了RFC规范的URI格式：\"http:\" \"//\" host [ \":\" port ] [ abs_path [ \"?\" query ]] ,并同时规定了CONNECT、OPTIONS、GET请求时的正确格式','PROTOCOL','block',1,1395124100,NULL),(4003,960912,'请求 Body是否正确','!@eq 0','该规则确定用户的请求体是否被正确的处理了，如果有错误将被阻断','PROTOCOL','block',1,1395124100,NULL),(4004,960914,'严格的Multipart数据解析检查','!@eq 0','该规则严格检查用户提交的窗体数据（multipart/form-data）,如果该规则对您的环境太严格，可以停用或修改规则动作为仅记录','PROTOCOL','block',1,1395124100,NULL),(4005,960915,'未匹配的Multipart Boundary检查','!@eq 0','该规则探测Multipart解析器探测到的可能的未匹配boundary','PROTOCOL','block',0,1395124100,NULL),(4002,981227,'multipart/form-data内容逃避','[\'\\\";=]','该规则检测在请求中利用Content-Disposition:头来偷传multipart/form-data的情况，比如：Content-Disposition: form-data; name=\"fileRap\"; filename=\"file=.txt\"','PROTOCOL','block',1,1395124100,NULL),(90050,981050,'检测公开的代理服务器是否被滥用或捆绑（Proxy Abuse）','GEO:COUNTRY_CODE "!@streq %{tx.geo_x-forwarded-for}"','如果检测到公开代理服务器被滥用，则阻断访问（Proxy Abuse）','OTHER','block',0,1452647413,NULL),(90051,981198,'检测http状态码及开源漏洞数据库(OSVDB）参数状态（Pvi Checks）','&RESOURCE:OSVDB_CHECK "@eq 0" RESPONSE_STATUS "@streq 200"','如果OSVDB的参数OSVDB_CHECK为0且响应状态码为200，则执行osvdb.lua脚本进行规则匹配检测（Pvi Checks）','OTHER','pass',0,1452647413,NULL),(90052,981199,'检测事务集合参数OSVDB_MSG（Pvi Checks）','X:OSVDB_MSG "!^$"','如果事务集合参数OSVDB_MSG匹配规则，则表示检测到漏洞，记录日志信息（Pvi Checks）','OTHER','pass',0,1452647413,NULL),(90064,960208,'检测请求参数的值长度是否过长(Request Limits)','&TX:ARG_LENGTH "@eq 1"','如果请求参数的值长度过长，则阻断访问(Request Limits)','OTHER','block',0,1452647413,NULL),(90063,960209,'检测请求参数名的长度是否过长(Request Limits)','&TX:ARG_NAME_LENGTH "@eq 1"','如果请求参数名的长度过长，则阻断访问(Request Limits)','OTHER','block',0,1452647413,NULL),(90059,960335,'检测请求参数的个数是否超过限制(Request Limits)','&TX:MAX_NUM_ARGS "@eq 1"','如果请求参数的个数超过限制，则阻断访问(Request Limits)','OTHER','block',0,1452647413,NULL),(90060,960341,'检测请求参数的总长度是否超过限制(Request Limits)','&TX:TOTAL_ARG_LENGTH "@eq 1"','如果请求参数的总长度超过限制，则阻断访问(Request Limits)','OTHER','block',0,1452647413,NULL),(90061,960342,'检测上传数据中单个文件的长度是否超过限制(Request Limits)','&TX:MAX_FILE_SIZE "@eq 1"','如果上传数据中单个文件的长度超过限制，则阻断访问(Request Limits)','OTHER','block',0,1452647413,NULL),(90062,960343,'检测上传数据中所有文件的总长度是否超过限制(Request Limits)','&TX:COMBINED_FILE_SIZES "@eq 1"','如果上传数据中所有文件的总长度超过限制，则阻断访问(Request Limits)','OTHER','block',0,1452647413,NULL),(90101,981187,'通过profile_page_scripts.lua脚本检测响应数据是否匹配规则（Response Profiling）','SecRuleScript profile_page_scripts.lua','通过profile_page_scripts.lua脚本检测响应数据是否匹配规则（Response Profiling）','OTHER','block',0,1452647413,NULL),(90100,981188,'检测资源集合中的参数是否包含有profile page的组成因素(niframes、nscripts、nlinks、nimages）（Response Profiling）','/(niframes|nscripts|nlinks|nimages)/','如果资源集合中的参数没有profile page的组成因素，则跳过Profile Page规则检测（Response Profiling）','OTHER','pass',0,1452647413,NULL),(90099,981189,'检测资源集合中是否包含有事务集合参数NIFRAMES（Response Profiling）','TX:NIFRAMES "@eq %{resource.niframes}"','如果资源集合中包含有事务集合参数NIFRAMES，则累计资源可信参数resource.profile_confidence_counter（Response Profiling）','OTHER','pass',0,1452647413,NULL),(90093,981190,'检测资源集合中是否包含有事务集合参数NSCRIPTS（Response Profiling）','TX:NSCRIPTS "@eq %{resource.nscripts}"','如果资源集合中包含有事务集合参数NSCRIPTS，则累计资源可信参数resource.profile_confidence_counter（Response Profiling）','OTHER','pass',0,1452647413,NULL),(90094,981191,'检测资源集合中是否包含有事务集合参数NLINKS（Response Profiling）','TX:NLINKS "@eq %{resource.nlinks}" ','如果资源集合中包含有事务集合参数NLINKS，则累计资源可信参数resource.profile_confidence_counter（Response Profiling）','OTHER','pass',0,1452647413,NULL),(90095,981192,'检测资源集合中是否包含有事务集合参数NIMAGES（Response Profiling）','TX:NIMAGES "@eq %{resource.nimages}"','如果资源集合中包含有事务集合参数NIMAGES，则累计资源可信参数resource.profile_confidence_counter（Response Profiling）','OTHER','pass',0,1452647413,NULL),(90096,981193,'检测资源集合中的PROFILE_CONFIDENCE_COUNTER数值是否少于等于40（Response Profiling）','RESOURCE:PROFILE_CONFIDENCE_COUNTER "@lt 40"','如果资源集合中的PROFILE_CONFIDENCE_COUNTER数值少于等于40，则跳过Profile Page 规则检测（Response Profiling）','OTHER','pass',0,1452647413,NULL),(90097,981194,'检测页面的IFRAMES参数值是否改变（Response Profiling）','TX:NIFRAMES "!@eq %{resource.niframes}"','如果页面的IFRAMES参数值发生改变，则阻断访问，并累计相关异常分数（Response Profiling）','OTHER','block',0,1452647413,NULL),(90098,981195,'检测页面的NSCRIPTS参数值是否改变（Response Profiling）','TX:NSCRIPTS "!@eq %{resource.nscripts}"','如果页面的NSCRIPTS参数值发生改变，则阻断访问，并累计相关异常分数（Response Profiling）','OTHER','block',0,1452647413,NULL),(90091,981196,'检测页面的NLINKS参数值是否改变（Response Profiling）','TX:NLINKS "!@eq %{resource.nlinks}" ','如果页面的NLINKS参数值发生改变，则阻断访问，并累计相关异常分数（Response Profiling）','OTHER','block',0,1452647413,NULL),(90092,981197,'检测页面的NIMAGES参数值是否改变（Response Profiling）','TX:NIMAGES "!@eq %{resource.nimages}"','如果页面的NIMAGES参数值发生改变，则阻断访问，并累计相关异常分数（Response Profiling）','OTHER','block',0,1452647413,NULL),(90124,981219,'检测GLOBAL集合的参数MISSING_CHARSET是否为0 （Response Profiling）','&GLOBAL:MISSING_CHARSET "@eq 0" ','如果GLOBAL集合的参数MISSING_CHARSET为0 ，则设置参数global.missing_charset=0（Response Profiling）','OTHER','pass',0,1452647413,NULL),(90001,999003,'检测XSS是否攻击已知的XSS弱点参数(Scanner Integration)','TX:/XSS-ARGS:/ ".*"','如果匹配规则，说明XSS攻击已知的弱点参数(Scanner Integration)','OTHER','block',0,1452647413,NULL),(90002,999004,'检测SQL是否攻击已知的SQL弱点参数(Scanner Integration)','TX:/SQL_INJECTION-ARGS:/ ".*"','如果匹配规则，说明SQL攻击已知的弱点参数(Scanner Integration)','OTHER','block',0,1452647413,NULL),(90173,981054,'检测提交的会话ID是否有效（Session Hijacking）','REQUEST_COOKIES: /(j?sessionid|(php)?sessid|(asp|jserv|jw)?session[-_]?(id)?|cf(id|token)|sid)/ ','如果提交的会话ID无效，则阻断访问（Session Hijacking）','OTHER','block',0,1452647413,NULL),(90172,981055,'检测提交的会话ID是否有效（Session Hijacking）',' REQUEST_COOKIES:/(j?sessionid|(php)?sessid|(asp|jserv|jw)?session[-_]?(id)?|cf(id|token)|sid)/','如果提交的会话ID有效，则跳过会话ID检测规则（Session Hijacking）','OTHER','block',0,1452647413,NULL),(90175,981056,'初始化会话ID（Session Hijacking）','setuid=%{session.username},session.sessionid=%{tx.sessionid}','初始化会话ID','OTHER','block',0,1452647413,NULL),(90174,981057,'检测会话启动时的请求数据，获取ip hash参数值（Session Hijacking）','REMOTE_ADDR "^(\d{1,3}\.\d{1,3}\.\d{1,3}\.)" ','检测REMOTE_ADDR及TX:1内容，如果匹配规则，则赋值ip hash参数值（Session Hijacking）','OTHER','block',0,1452647413,NULL),(90177,981058,'检测会话启动时的请求数据，获取ua hash参数值（Session Hijacking）','REQUEST_HEADERS:User-Agent ".*"','检测请求头的User-Agent字段内容，如果匹配规则，则赋值ua hash参数值（Session Hijacking）','OTHER','block',0,1452647413,NULL),(90176,981059,'检测会话的IP地址是否匹配（Session Hijacking）','TX:IP_HASH "!@streq %{SESSION.IP_HASH}"','如果会话的IP地址不匹配，则阻断访问（Session Hijacking）','OTHER','block',0,1452647413,NULL),(90178,981060,'检测会话的User-Agent是否匹配（Session Hijacking）','TX:UA_HASH "!@streq %{SESSION.UA_HASH}"','如果会话的User-Agent不匹配，则阻断访问（Session Hijacking）','OTHER','block',0,1452647413,NULL),(90179,981061,'检测会话连接时出现的异常个数（Session Hijacking）','TX:STICKY_SESSION_ANOMALY "@eq 2"','如果会话的IP地址和User-Agent都不匹配，则阻断访问（Session Hijacking）','OTHER','block',0,1452647413,NULL),(90180,981062,'检测响应头的Set-Cookie字段（Session Hijacking）',' (?i:(j?sessionid|(php)?sessid|(asp|jserv|jw)?session[-_]?(id)?|cf(id|token)|sid).*?=([^\s].*?)\;\s?)','检测响应头的Set-Cookie字段数据，设置相关参数：会话ID、IP地址、User-Agent等（Session Hijacking）','OTHER','block',0,1452647413,NULL),(90181,981063,'检测响应数据中的会话IP地址，获取ip hash参数值（Session Hijacking）','REMOTE_ADDR "^(\d{1,3}\.\d{1,3}\.\d{1,3}\.)" ','检测响应数据中的会话IP地址，如果匹配规则，则赋值ip hash参数值（Session Hijacking）','OTHER','block',0,1452647413,NULL),(90171,981064,'检测响应数据中的会话User-Agent地址，获取ua hash参数值（Session Hijacking）','REQUEST_HEADERS:User-Agent ".*"','检测响应数据中的会话User-Agent地址，如果匹配规则，则赋值ua hash参数值（Session Hijacking）','OTHER','block',0,1452647413,NULL),(90150,999008,'检测是否要跳过关于没有参数的文本内容请求数据的检查（Skip Outbound Checks）','TX:text_file_extension "@eq 1" TX:no_parameters "@eq 1"','如果匹配规则，则跳过关于没有参数的文本内容请求数据的检查（Skip Outbound Checks）','OTHER','block',0,1452647413,NULL),(90003,981051,'检测Apache返回的HTTP响应状态码(Slow Dos Protection)','RESPONSE_STATUS "@streq 408"','检测Apache返回的HTTP响应状态码是否为408，若为true，则累加ip的slow_dos_counter值(Slow Dos Protection)','OTHER','block',0,1452647413,NULL),(90004,981052,'检测slow_dos_counter的数值(Slow Dos Protection)','IP:SLOW_DOS_COUNTER "@gt 5"','检测slow_dos_counter的值是否大于5，若符合规则，则drop掉数据包(Slow Dos Protection)','OTHER','block',0,1452647413,NULL), (1024,950001,'SQL注入检测之一(OWASP TOP 10)','(?i:(?:(?:s(?:t(?:d(?:dev(_pop|_samp)?)?|r(?:_to_date|cmp))|u(?:b(?:str(?:ing(_index)?)?|(?:dat|tim)e)|m)|e(?:c(?:_to_time|ond)|ssion_user)|ys(?:tem_user|date)|ha(1|2)?|oundex|chema|ig?n|pace|qrt)|i(?:s(null|_(free_lock|ipv4_compat|ipv4_mapped|ipv4|ipv6|not_null|not|null|used_lock))?|n(?:et6?_(aton|ntoa)|s(?:ert|tr)|terval)?|f(null)?)|u(?:n(?:compress(?:ed_length)?|ix_timestamp|hex)|tc_(date|time|timestamp)|p(?:datexml|per)|uid(_short)?|case|ser)|l(?:o(?:ca(?:l(timestamp)?|te)|g(2|10)?|ad_file|wer)|ast(_day|_insert_id)?|e(?:(?:as|f)t|ngth)|case|trim|pad|n)|t(?:ime(stamp|stampadd|stampdiff|diff|_format|_to_sec)?|o_(base64|days|seconds|n?char)|r(?:uncate|im)|an)|m(?:a(?:ke(?:_set|date)|ster_pos_wait|x)|i(?:(?:crosecon)?d|n(?:ute)?)|o(?:nth(name)?|d)|d5)|r(?:e(?:p(?:lace|eat)|lease_lock|verse)|o(?:w_count|und)|a(?:dians|nd)|ight|trim|pad)|f(?:i(?:eld(_in_set)?|nd_in_set)|rom_(base64|days|unixtime)|o(?:und_rows|rmat)|loor)|a(?:es_(?:de|en)crypt|s(?:cii(str)?|in)|dd(?:dat|tim)e|(?:co|b)s|tan2?|vg)|p(?:o(?:sition|w','OWASP排名前10的SQL注入检测','SQLI','block',1,1395124100,NULL), (1023,950007,'SQL盲注检测(OWASP TOP 10)','(?i:(?:\\b(?:(?:s(?:ys\\.(?:user_(?:(?:t(?:ab(?:_column|le)|rigger)|object|view)s|c(?:onstraints|atalog))|all_tables|tab)|elect\\b.{0,40}\\b(?:substring|users?|ascii))|m(?:sys(?:(?:queri|ac)e|relationship|column|object)s|ysql\\.(db|user))|c(?:onstraint_type|harindex)|waitfor\\b\\W*?\\bdelay|attnotnull)\\b|(?:locate|instr)\\W+\\()|\\@\\@spid\\b)|\\b(?:(?:s(?:ys(?:(?:(?:process|tabl)e|filegroup|object)s|c(?:o(?:nstraint|lumn)s|at)|dba|ibm)|ubstr(?:ing)?)|user_(?:(?:(?:constrain|objec)t|tab(?:_column|le)|ind_column|user)s|password|group)|a(?:tt(?:rel|typ)id|ll_objects)|object_(?:(?:nam|typ)e|id)|pg_(?:attribute|class)|column_(?:name|id)|xtype\\W+\\bchar|mb_users|rownum)\\b|t(?:able_name\\b|extpos\\W+\\()))','OWASP排名前10的SQL盲注检测','SQLI','block',1,1395124100,NULL),(1005,950901,'永远为真条件表达式检测','(?i:([\\s\'\\\"`′’‘\\(\\)]*?)\\b([\\d\\w]++)([\\s\'\\\"`′’‘\\(\\)]*?)(?:(?:=|<=>|r?like|sounds\\s+like|regexp)([\\s\'\\\"`′’‘\\(\\)]*?)\\2\\b|(?:!=|<=|>=|<>|<|>|\\^|is\\s+not|not\\s+like|not\\s+regexp)([\\s\'\\\"`′’‘\\(\\)]*?)(?!\\2)([\\d\\w]+)\\b))','检测永远返回真的SQL条件语句，最常见的攻击手法如： 利用OR 1=1来返回所有记录','SQLI','block',1,1395124100,NULL),(1029,950908,'SQL注入检测之六','(?i:\\b(?:coalesce\\b|root\\@))','SQL注入检测','SQLI','block',1,1395124100,NULL), (1025,959070,'SQL注入检测之二(OWASP TOP 10)','\\b(?i:having)\\b\\s+(\\d{1,10}|\'[^=]{1,10}\')\\s*?[=<>]|(?i:\\bexecute(\\s{1,5}[\\w\\.$]{1,5}\\s{0,3})?\\()|\\bhaving\\b ?(?:\\d{1,10}|[\\\'\\\"][^=]{1,10}[\\\'\\\"]) ?[=<>]+|(?i:\\bcreate\\s+?table.{0,20}?\\()|(?i:\\blike\\W*?char\\W*?\\()|(?i:(?:(select(.*?)case|from(.*?)limit|order\\sby)))|exists\\s(\\sselect|select\\Sif(null)?\\s\\(|select\\Stop|select\\Sconcat|system\\s\\(|\\b(?i:having)\\b\\s+(\\d{1,10})|\'[^=]{1,10}\')','OWASP排名前10的SQL注入检测','SQLI','block',1,1395124100,NULL),(1026,959071,'SQL注入检测之三(OWASP TOP 10)','(?i:\\bor\\b ?(?:\\d{1,10}|[\\\'\\\"][^=]{1,10}[\\\'\\\"]) ?[=<>]+|(?i:\'\\s+x?or\\s+.{1,20}[+\\-!<>=])|\\b(?i:x?or)\\b\\s+(\\d{1,10}|\'[^=]{1,10}\')|\\b(?i:x?or)\\b\\s+(\\d{1,10}|\'[^=]{1,10}\')\\s*?[=<>])','OWASP排名前10的SQL注入检测','SQLI','block',1,1395124100,NULL),(1027,959072,'SQL注入检测之四(OWASP TOP 10)','(?i)\\b(?i:and)\\b\\s+(\\d{1,10}|\'[^=]{1,10}\')\\s*?[=]|\\b(?i:and)\\b\\s+(\\d{1,10}|\'[^=]{1,10}\')\\s*?[<>]|\\band\\b ?(?:\\d{1,10}|[\\\'\\\"][^=]{1,10}[\\\'\\\"]) ?[=<>]+|\\b(?i:and)\\b\\s+(\\d{1,10}|\'[^=]{1,10}\')','OWASP排名前10的SQL注入检测','SQLI','block',1,1395124100,NULL),(1028,959073,'SQL注入检测之五(OWASP TOP 10)','(?i:(?:(?:s(?:t(?:d(?:dev(_pop|_samp)?)?|r(?:_to_date|cmp))|u(?:b(?:str(?:ing(_index)?)?|(?:dat|tim)e)|m)|e(?:c(?:_to_time|ond)|ssion_user)|ys(?:tem_user|date)|ha(1|2)?|oundex|chema|ig?n|pace|qrt)|i(?:s(null|_(free_lock|ipv4_compat|ipv4_mapped|ipv4|ipv6|not_null|not|null|used_lock))?|n(?:et6?_(aton|ntoa)|s(?:ert|tr)|terval)?|f(null)?)|u(?:n(?:compress(?:ed_length)?|ix_timestamp|hex)|tc_(date|time|timestamp)|p(?:datexml|per)|uid(_short)?|case|ser)|l(?:o(?:ca(?:l(timestamp)?|te)|g(2|10)?|ad_file|wer)|ast(_day|_insert_id)?|e(?:(?:as|f)t|ngth)|case|trim|pad|n)|t(?:ime(stamp|stampadd|stampdiff|diff|_format|_to_sec)?|o_(base64|days|seconds|n?char)|r(?:uncate|im)|an)|m(?:a(?:ke(?:_set|date)|ster_pos_wait|x)|i(?:(?:crosecon)?d|n(?:ute)?)|o(?:nth(name)?|d)|d5)|r(?:e(?:p(?:lace|eat)|lease_lock|verse)|o(?:w_count|und)|a(?:dians|nd)|ight|trim|pad)|f(?:i(?:eld(_in_set)?|nd_in_set)|rom_(base64|days|unixtime)|o(?:und_rows|rmat)|loor)|a(?:es_(?:de|en)crypt|s(?:cii(str)?|in)|dd(?:dat|tim)e|(?:co|b)s|tan2?|vg)|p(?:o(?:sition|w','OWASP排名前10的SQL注入检测','SQLI','block',1,1395124100,NULL), (1030,981172,'SQL注入字符的异常使用检测','([\\~\\!\\@\\#\\$\\%\\^\\&\\*\\(\\)\\-\\+\\=\\{\\}\\[\\]\\|\\:\\;\\\"\\\'\\′\\’\\‘\\`\\<\\>].*?){8,}([\\~\\!\\@\\#\\$\\%\\^\\&\\*\\(\\)\\-\\+\\=\\{\\}\\[\\]\\|\\:\\;\\\"\\\'\\′\\’\\‘\\`\\<\\>].*?){8,}','通过探测在COOKIE中出现:#*%$!等字符的次数来判断是否存在注入风险','SQLI','block',1,1395124100,NULL),(1031,981173,'SQL注入字符的异常使用检测','([\\~\\!\\@\\#\\$\\%\\^\\&\\*\\(\\)\\-\\+\\=\\{\\}\\[\\]\\|\\:\\;\\\"\\\'\\′\\’\\‘\\`\\<\\>].*?){4,}','通过探测URL参数中传递的值是否出现：#*%!等字符超出预期次数，来判断注入风险','SQLI','block',1,1395124100,NULL),(1001,981231,'探测SQL注释符号','(/\\*!?|\\*/|[\';]--|--[\\s\\r\\n\\v\\f]|(?:--[^-]*?-)|([^\\-&])#.*?[\\s\\r\\n\\v\\f]|;?\\\\x00)','探测常见的SQL脚本中的注释字符，如-- /**/等','SQLI','block',1,1395124100,NULL), (1046,981240,'使用SQL注释符号，char函数，或其他条件语句等的注入','(?i:(?:\\)\\s*?when\\s*?\\d+\\s*?then)|(?:[\\\"\'`′’‘]\\s*?(?:#|--|{))|(?:\\/\\*!\\s?\\d+)|(?:ch(?:a)?r\\s*?\\(\\s*?\\d)|(?:(?:(n?and|x?x?or|div|like|between|and|not)\\s+|\\|\\||\\&\\&)\\s*?\\w+\\())','探测利用SQL注释符号-- /* #等，或者利用char(数字)函数等伪装的注入，并且检测其他between and ,like，|| &&等组成的条件语句','SQLI','block',1,1395124100,NULL),(1039,981241,'sql语句条件注入检测','(?i:(?:[\\s()]case\\s*?\\()|(?:\\)\\s*?like\\s*?\\()|(?:having\\s*?[^\\s]+\\s*?[^\\w\\s])|(?:if\\s?\\([\\d\\w]\\s*?[=<>~]))','检测sql语句查询条件语句拼装注入，如like,having等','SQLI','block',1,1395124100,NULL),(1049,981242,'经典sql注入探测之一','(?i:(?:[\\\"\'`′’‘]\\s*?(x?or|div|like|between|and)\\s*?[\\\"\'`′’‘]?\\d)|(?:\\\\\\\\x(?:23|27|3d))|(?:^.?[\\\"\'`′’‘]$)|(?:(?:^[\\\"\'`′’‘\\\\\\\\]*?(?:[\\d\\\"\'`′’‘]+|[^\\\"\'`′’‘]+[\\\"\'`′’‘]))+\\s*?(?:n?and|x?x?or|div|like|between|and|not|\\|\\||\\&\\&)\\s*?[\\w\\\"\'`′’‘][+&!@(),.-])|(?:[^\\w\\s]\\w+\\s*?[|-]\\s*?[\\\"\'`′’‘]\\s*?\\w)|(?:@\\w+\\s+(and|x?or|div|like|between|and)\\s*?[\\\"\'`′’‘\\d]+)|(?:@[\\w-]+\\s(and|x?or|div|like|between|and)\\s*?[^\\w\\s])|(?:[^\\w\\s:]\\s*?\\d\\W+[^\\w\\s]\\s*?[\\\"\'`′’‘].)|(?:\\Winformation_schema|table_name\\W))','攻击者在找到注入点后往往会尝试从information_schema.table_name来获取数据库的元数据信息','SQLI','block',1,1395124100,NULL),(1053,981243,'经典sql注入探测之二','(?i:(?:[\\\"\'`′’‘]\\s*?\\*.+(?:x?or|div|like|between|and|id)\\W*?[\\\"\'`′’‘]\\d)|(?:\\^[\\\"\'`′’‘])|(?:^[\\w\\s\\\"\'`′’‘-]+(?<=and\\s)(?<=or|xor|div|like|between|and\\s)(?<=xor\\s)(?<=nand\\s)(?<=not\\s)(?<=\\|\\|)(?<=\\&\\&)\\w+\\()|(?:[\\\"\'`′’‘][\\s\\d]*?[^\\w\\s]+\\W*?\\d\\W*?.*?[\\\"\'`′’‘\\d])|(?:[\\\"\'`′’‘]\\s*?[^\\w\\s?]+\\s*?[^\\w\\s]+\\s*?[\\\"\'`′’‘])|(?:[\\\"\'`′’‘]\\s*?[^\\w\\s]+\\s*?[\\W\\d].*?(?:#|--))|(?:[\\\"\'`′’‘].*?\\*\\s*?\\d)|(?:[\\\"\'`′’‘]\\s*?(x?or|div|like|between|and)\\s[^\\d]+[\\w-]+.*?\\d)|(?:[()\\*<>%+-][\\w-]+[^\\w\\s]+[\\\"\'`′’‘][^,]))','探测一些攻击者在攻击开始阶段尝试对数据库执行多种不同的查询操作，每次传送不同的查询条件，根据反馈结果来猜测数据库注入点和数据库结构的操作','SQLI','block',1,1395124100,NULL),(1033,981244,'SQL基础认证BYPASS之一','(?i:(?i:\\d[\\\"\'`′’‘]\\s+[\\\"\'`′’‘]\\s+\\d)|(?:^admin\\s*?[\\\"\'`′’‘]|(\\/\\*)+[\\\"\'`′’‘]+\\s?(?:--|#|\\/\\*|{)?)|(?:[\\\"\'`′’‘]\\s*?\\b(x?or|div|like|between|and)\\b\\s*?[+<>=(),-]\\s*?[\\d\\\"\'`′’‘])|(?:[\\\"\'`′’‘]\\s*?[^\\w\\s]?=\\s*?[\\\"\'`′’‘])|(?:[\\\"\'`′’‘]\\W*?[+=]+\\W*?[\\\"\'`′’‘])|(?:[\\\"\'`′’‘]\\s*?[!=|][\\d\\s!=+-]+.*?[\\\"\'`′’‘(].*?$)|(?:[\\\"\'`′’‘]\\s*?[!=|][\\d\\s!=]+.*?\\d+$)|(?:[\\\"\'`′’‘]\\s*?like\\W+[\\w\\\"\'`′’‘(])|(?:\\sis\\s*?0\\W)|(?:where\\s[\\s\\w\\.,-]+\\s=)|(?:[\\\"\'`′’‘][<>~]+[\\\"\'`′’‘]))','探测企图绕过SQL基础认证的尝试','SQLI','block',1,1395124100,NULL),(1042,981245,'SQL基础认证BYPASS之二','(?i:(?:union\\s*?(?:all|distinct|[(!@]*?)?\\s*?[([]*?\\s*?select\\s+)|(?:\\w+\\s+like\\s+[\\\"\'`′’‘])|(?:like\\s*?[\\\"\'`′’‘]\\%)|(?:[\\\"\'`′’‘]\\s*?like\\W*?[\\\"\'`′’‘\\d])|(?:[\\\"\'`′’‘]\\s*?(?:n?and|x?x?or|div|like|between|and|not |\\|\\||\\&\\&)\\s+[\\s\\w]+=\\s*?\\w+\\s*?having\\s+)|(?:[\\\"\'`′’‘]\\s*?\\*\\s*?\\w+\\W+[\\\"\'`′’‘])|(?:[\\\"\'`′’‘]\\s*?[^?\\w\\s=.,;)(]+\\s*?[(@\\\"\'`′’‘]*?\\s*?\\w+\\W+\\w)|(?:select\\s+?[\\[\\]()\\s\\w\\.,\\\"\'`′’‘-]+from\\s+)|(?:find_in_set\\s*?\\())','探测企图绕过SQL基础认证的尝试','SQLI','block',1,1395124100,NULL),(1050,981246,'SQL基础认证BYPASS之三','(?i:(?:in\\s*?\\(+\\s*?select)|(?:(?:n?and|x?x?or|div|like|between|and|not |\\|\\||\\&\\&)\\s+[\\s\\w+]+(?:regexp\\s*?\\(|sounds\\s+like\\s*?[\\\"\'`′’‘]|[=\\d]+x))|([\\\"\'`′’‘]\\s*?\\d\\s*?(?:--|#))|(?:[\\\"\'`′’‘][\\%&<>^=]+\\d\\s*?(=|x?or|div|like|between|and))|(?:[\\\"\'`′’‘]\\W+[\\w+-]+\\s*?=\\s*?\\d\\W+[\\\"\'`′’‘])|(?:[\\\"\'`′’‘]\\s*?is\\s*?\\d.+[\\\"\'`′’‘]?\\w)|(?:[\\\"\'`′’‘]\\|?[\\w-]{3,}[^\\w\\s.,]+[\\\"\'`′’‘])|(?:[\\\"\'`′’‘]\\s*?is\\s*?[\\d.]+\\s*?\\W.*?[\\\"\'`′’‘]))','探测企图绕过SQL基础认证的尝试','SQLI','block',1,1395124100,NULL),(1052,981247,'串联的基本SQL注入，和SQLLFI尝试','(?i:(?:[\\d\\W]\\s+as\\s*?[\\\"\'`′’‘\\w]+\\s*?from)|(?:^[\\W\\d]+\\s*?(?:union|select|create|rename|truncate|load|alter|delete|update|insert|desc))|(?:(?:select|create|rename|truncate|load|alter|delete|update|insert|desc)\\s+(?:(?:group_)concat|char|load_file)\\s?\\(?)|(?:end\\s*?\\);)|([\\\"\'`′’‘]\\s+regexp\\W)|(?:[\\s(]load_file\\s*?\\())','探测一些基本的select、create、rename、alter、update、delete等基本sql语句的串连操作，以及通过load_file等进行的LFI尝试','SQLI','block',1,1395124100,NULL),(1036,981248,'链式SQL注入检测之一','(?i:(?:@.+=\\s*?\\(\\s*?select)|(?:\\d+\\s*?(x?or|div|like|between|and)\\s*?\\d+\\s*?[\\-+])|(?:\\/\\w+;?\\s+(?:having|and|x?or|div|like|between|and|select)\\W)|(?:\\d\\s+group\\s+by.+\\()|(?:(?:;|#|--)\\s*?(?:drop|alter))|(?:(?:;|#|--)\\s*?(?:update|insert)\\s*?\\w{2,})|(?:[^\\w]SET\\s*?@\\w+)|(?:(?:n?and|x?x?or|div|like|between|and|not |\\|\\||\\&\\&)[\\s(]+\\w+[\\s)]*?[!=+]+[\\s\\d]*?[\\\"\'`′’‘=()]))','探测通过--#等注释符号或;等符号拼装成的链式SQL注入检测','SQLI','block',1,1395124100,NULL),(1047,981249,'链式SQL注入检测之二','(?i:(?:[\\\"\'`′’‘]\\s+and\\s*?=\\W)|(?:\\(\\s*?select\\s*?\\w+\\s*?\\()|(?:\\*\\/from)|(?:\\+\\s*?\\d+\\s*?\\+\\s*?@)|(?:\\w[\\\"\'`′’‘]\\s*?(?:[-+=|@]+\\s*?)+[\\d(])|(?:coalesce\\s*?\\(|@@\\w+\\s*?[^\\w\\s])|(?:\\W!+[\\\"\'`′’‘]\\w)|(?:[\\\"\'`′’‘];\\s*?(?:if|while|begin))|(?:[\\\"\'`′’‘][\\s\\d]+=\\s*?\\d)|(?:order\\s+by\\s+if\\w*?\\s*?\\()|(?:[\\s(]+case\\d*?\\W.+[tw]hen[\\s(]))','探测复杂的SQL查询语句，这些语句往往通过; () 或其他 if then when case等组成复杂的SQL语句查询','SQLI','block',1,1395124100,NULL),(1038,981250,'benchmark和sleep函数注入检测','(?i:(?:(select|;)\\s+(?:benchmark|if|sleep)\\s*?\\(\\s*?\\(?\\s*?\\w+))','探测在sql语句包括条件查询中的benchmark和sleep函数注入尝试','SQLI','block',1,1395124100,NULL), (1051,981251,'MySQL UDF注入，及其他的改变数据/结构的操作','(?i:(?:create\\s+function\\s+\\w+\\s+returns)|(?:;\\s*?(?:select|create|rename|truncate|load|alter|delete|update|insert|desc)\\s*?[\\[(]?\\w{2,}))','探测创建函数create function returns等操作，或其他的create rename truncate alter update delete insert desc等企图改变数据结构或改变数据内容的操作','SQLI','block',1,1395124100,NULL),(1040,981252,'MySQL字符集转换和MSSQL DOS攻击检测','(?i:(?:alter\\s*?\\w+.*?character\\s+set\\s+\\w+)|([\\\"\'`′’‘];\\s*?waitfor\\s+time\\s+[\\\"\'`′’‘])|(?:[\\\"\'`′’‘];.*?:\\s*?goto))','检测通过alter character set修改MySQL字符集，通过waitfor time等操作进行MSSQL DOS攻击的尝试','SQLI','block',1,1395124100,NULL),(1048,981253,'针对MySQL和PostgreSQL的存储过程及函数注入','(?i:(?:procedure\\s+analyse\\s*?\\()|(?:;\\s*?(declare|open)\\s+[\\w-]+)|(?:create\\s+(procedure|function)\\s*?\\w+\\s*?\\(\\s*?\\)\\s*?-)|(?:declare[^\\w]+[@#]\\s*?\\w+)|(exec\\s*?\\(\\s*?@))','通过探测 create procedure function declare @ # exec等来确定针对MySQL和PostgreSQL的存储过程和函数注入攻击','SQLI','block',1,1395124100,NULL),(1044,981254,'针对Postgres的pg_sleep注入, 以及waitfor delay攻击，还有试图关闭数据库（shutdown）','(?i:(?:select\\s*?pg_sleep)|(?:waitfor\\s*?delay\\s?[\\\"\'`′’‘]+\\s?\\d)|(?:;\\s*?shutdown\\s*?(?:;|--|#|\\/\\*|{)))','探测针对Postgres的pg_sleep注入, 以及waitfor delay攻击，还有试图通过shutdown指令关闭数据库的操作','SQLI','block',1,1395124100,NULL),(1034,981255,'MSSQL代码执行及信息收集检测','(?i:(?:\\sexec\\s+xp_cmdshell)|(?:[\\\"\'`′’‘]\\s*?!\\s*?[\\\"\'`′’‘\\w])|(?:from\\W+information_schema\\W)|(?:(?:(?:current_)?user|database|schema|connection_id)\\s*?\\([^\\)]*?)|(?:[\\\"\'`′’‘];?\\s*?(?:select|union|having)\\s*?[^\\s])|(?:\\wiif\\s*?\\()|(?:exec\\s+master\\.)|(?:union select @)|(?:union[\\w(\\s]*?select)|(?:select.*?\\w?user\\()|(?:into[\\s+]+(?:dump|out)file\\s*?[\\\"\'`′’‘]))','探测攻击者企图执行MSSQL数据库代码，及收集数据库信息的企图','SQLI','block',1,1395124100,NULL),(1041,981256,'MATCH AGAINST, MERGE, EXECUTE IMMEDIATE和HAVING等注入','(?i:(?:merge.*?using\\s*?\\()|(execute\\s*?immediate\\s*?[\\\"\'`′’‘])|(?:\\W+\\d*?\\s*?having\\s*?[^\\s\\-])|(?:match\\s*?[\\w(),+-]+\\s*?against\\s*?\\())','检测用户提交的内容中的MATCH AGAINST, MERGE, EXECUTE IMMEDIATE，HAVING等关键词的注入','SQLI','block',1,1395124100,NULL),(1035,981257,'MySQL数据库检测','(?i:(?:,.*?[)\\da-f\\\"\'`′’‘][\\\"\'`′’‘](?:[\\\"\'`′’‘].*?[\\\"\'`′’‘]|\\Z|[^\\\"\'`′’‘]+))|(?:\\Wselect.+\\W*?from)|((?:select|create|rename|truncate|load|alter|delete|update|insert|desc)\\s*?\\(\\s*?space\\s*?\\())','探测mysql数据库的注释区间混淆和反单引号中断的检测','SQLI','block',1,1395124100,NULL),(1002,981260,'十六进制SQL规避方法','(?i:(?:\\A|[^\\d])0x[a-f\\d]{3,}[a-f\\d]*)+','很多SQL注入为了逃避检测，往往将攻击内容进行十六进制编码','SQLI','block',1,1395124100,NULL),(1045,981270,'针对MongoDB的基本SQL注入','(?i:(?:\[\$(?:ne|eq|lte?|gte?|n?in|mod|all|size|exists|type|slice|x?or|div|like|between|and)\]))','探测针对MongoDB的基本sql 注入，主要关键词有：[$eq][$all][$like][$between][$and]等','SQLI','block',0,1395124100,NULL),(1032,981272,'探测盲注测试','(?i:(sleep\\((\\s*?)(\\d*?)(\\s*?)\\)|benchmark\\((.*?)\\,(.*?)\\)))','探测通过利用sleep() or benchmark()等函数进行的盲注测试','SQLI','block',1,1395124100,NULL),(1043,981276,'基本SQL注入，在攻击MySQL,ORACLE或其他数据库时通常会出现的字符串','(?i:(?:(union(.*?)select(.*?)from)))','基本SQL注入，在攻击MySQL,ORACLE或其他数据库时通常会出现的字符串，通常是 union select from这样的形式','SQLI','block',1,1395124100,NULL),(1037,981277,'整数溢出攻击检测','(?i:(?:^(-0000023456|4294967295|4294967296|2147483648|2147483647|0000012345|-2147483648|-2147483649|0000023456|2.2.80738585072007e-308|1e309)$))','探测整数溢出攻击，比如skipfish中的魔数：2.2.80738585072007e-308','SQLI','block',0,1395124100,NULL),(90113,981300,'检测请求数据中的内容是否与现有的关键词匹配','REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@pm select show top distinct from dual where group by order having limit offset union rownum as (case" ','如果有关键词匹配，则设置tx.sqli_select_statement参数值','SQLI','pass',0,1452647413,NULL),(1007,981301,'select关键词检测','select','SQL关键词检测，当检测到select后积分+1,默认当积分>3后阻断攻击','SQLI','pass',0,1395124100,NULL),(1008,981302,'show关键词检测','show','SQL关键词检测，当检测到show后积分+1,默认当积分>3后阻断攻击','SQLI','pass',1,1395124100,NULL),(1009,981303,'top关键词检测','top','SQL关键词检测，当检测到top后积分+1,默认当积分>3后阻断攻击','SQLI','pass',1,1395124100,NULL),(1010,981304,'distinct关键词检测','distinct','SQL关键词检测，当检测到distinct后积分+1,默认当积分>3后阻断攻击','SQLI','pass',1,1395124100,NULL),(1011,981305,'from关键词检测','from','SQL关键词检测，当检测到from后积分+1,默认当积分>3后阻断攻击','SQLI','pass',1,1395124100,NULL),(1012,981306,'dual关键词检测','dual','SQL关键词检测，当检测到dual后积分+1,默认当积分>3后阻断攻击','SQLI','pass',1,1395124100,NULL),(1013,981307,'where关键词检测','where','SQL关键词检测，当检测到where后积分+1,默认当积分>3后阻断攻击','SQLI','pass',1,1395124100,NULL),(1014,981308,'group by关键词检测','group by','SQL关键词检测，当检测到group by后积分+1,默认当积分>3后阻断攻击','SQLI','pass',1,1395124100,NULL),(1015,981309,'order by关键词检测','order by','SQL关键词检测，当检测到order by后积分+1,默认当积分>3后阻断攻击','SQLI','pass',1,1395124100,NULL),(1016,981310,'having关键词检测','having','SQL关键词检测，当检测到having后积分+1,默认当积分>3后阻断攻击','SQLI','pass',1,1395124100,NULL),(1017,981311,'limit关键词检测','limit','SQL关键词检测，当检测到limit后积分+1,默认当积分>3后阻断攻击','SQLI','pass',1,1395124100,NULL),(1018,981312,'offset关键词检测','offset','SQL关键词检测，当检测到offset后积分+1,默认当积分>3后阻断攻击','SQLI','pass',1,1395124100,NULL),(1019,981313,'union关键词检测','union','SQL关键词检测，当检测到union后积分+1,默认当积分>3后阻断攻击','SQLI','pass',1,1395124100,NULL),(1020,981314,'union all关键词检测','union all','SQL关键词检测，当检测到union all后积分+1,默认当积分>3后阻断攻击','SQLI','pass',1,1395124100,NULL),(1021,981315,'rownum as关键词检测','rownum as','SQL关键词检测，当检测到rownum as后积分+1,默认当积分>3后阻断攻击','SQLI','pass',1,1395124100,NULL),(1022,981316,'(case关键词检测','(case','SQL关键词检测，当检测到(case后积分+1,默认当积分>3后阻断攻击','SQLI','pass',1,1395124100,NULL),(90114,981317,'检测SQL关键词的总数','TX:SQLI_SELECT_STATEMENT_COUNT "@ge 3"','如果检测到SQL关键词总数大与等于3，则阻断访问','SQLI','block',0,1452647413,NULL),(1003,981318,'SQL常用注入测试','(^[\\\"\'`′’‘;]+|[\\\"\'`′’‘;]+$)','识别常见的初始SQL注入探测请求，攻击者尝试在正常的输入位置插入/追加引号字符等，看看web应用程序/数据库如何响应。','SQLI','block',1,1395124100,NULL),(1004,981319,'SQL常见操作符检测','(?i:(\\!\\=|\\&\\&|\\|\\||>>|<<|>=|<=|<>|<=>|xor|rlike|regexp|isnull)|(?:not\\s+between\\s+0\\s+and)|(?:is\\s+null)|(like\\s+null)|(?:(?:^|\\W)in[+\\s]*\\([\\s\\d\\\"]+[^()]*\\))|(?:xor|<>|rlike(?:\\s+binary)?)|(?:regexp\\s+binary))','通过检测SQL语句中的常见操作符来判断SQL注入攻击，如常见的：xor|rlike|regexp|isnullnot|between|and|like|in等','SQLI','block',1,1395124100,NULL),(1006,981320,'数据库名字探测','(?i:(?:m(?:s(?:ysaccessobjects|ysaces|ysobjects|ysqueries|ysrelationships|ysaccessstorage|ysaccessxml|ysmodules|ysmodules2|db)|aster\\.\\.sysdatabases|ysql\\.db)|s(?:ys(?:\\.database_name|aux)|chema(?:\\W*\\(|_name)|qlite(_temp)?_master)|d(?:atabas|b_nam)e\\W*\\(|information_schema|pg_(catalog|toast)|northwind|tempdb))','检测输入中是否出现一些数据库系统中常见的数据库名，如：master、sysobjects等','SQLI','block',1,1395124100,NULL),(90049,950103,'检测请求数据判断是否发生路径遍历攻击（Tight Security）','(?i)(?:\x5c|(?:%(?:2(?:5(?:2f|5c)|%46|f)|c(?:0%(?:9v|af)|1%1c)|u(?:221[56]|002f)|%32(?:%46|F)|e0%80%af|1u|5c)|\/))(?:%(?:2(?:(?:52)?e|%45)|(?:e0%8|c)0%ae|u(?:002e|2024)|%32(?:%45|E))|\.){2}(?:\x5c|(?:%(?:2(?:5(?:2f|5c)|%46|f)|c(?:0%(?:9v|af)|1%1c)|u(?:221[56]|002f)|%32(?:%46|F)|e0%80%af|1u|5c)|\/))','检测请求数据判断是否发生路径遍历攻击，如果发生攻击，则阻断请求（Tight Security）','OTHER','block',0,1452647413,NULL),(5001,950110,'通过x_key头访问后门(OWASP TOP 10)','x_(?:key|file)','该规则检测Http请求头中是否有x_key***,x_file***这样的头字段，如果存在则可能是攻击者试图访问后门程序，阻断','TROJANS','block',1,1395124100,NULL),(5002,950921,'访问root.exe后门程序(OWASP TOP 10)','root\.exe','该规则检测uri请求中的文件名，如果访问root.exe文件，则阻断','TROJANS','block',1,1395124100,NULL),(5003,950922,'通过响应判断后门反问(OWASP TOP 10)','(?:<title>[^<]*?(?:\\b(?:(?:c(?:ehennemden|gi-telnet)|gamma web shell)\\b|imhabirligi phpftp)|(?:r(?:emote explorer|57shell)|aventis klasvayv|zehir)\\b|\\.::(?:news remote php shell injection::\\.| rhtools\\b)|ph(?:p(?:(?: commander|-terminal)\\b|remoteview)|vayv)|myshell)|\\b(?:(?:(?:microsoft windows\\b.{0,10}?\\bversion\\b.{0,20}?\\(c\\) copyright 1985-.{0,10}?\\bmicrosoft corp|ntdaddy v1\\.9 - obzerve \\| fux0r inc)\\.|(?:www\\.sanalteror\\.org - indexer and read|haxplor)er|php(?:konsole| shell)|c99shell)\\b|aventgrup\\.<br>|drwxr))','该规则检测web应用程序给用户返回的响应，如果响应中含有：remote explorer,r57shell,gamma web shell, php commander,myshell,php konsole,c99shell等,如有则可能是后门访问的响应，阻断','TROJANS','block',1,1395124100,NULL),(90013,981053,'检测请求content-type是否为xml（XML ENABLER）','REQUEST_HEADERS:Content-Type "text/xml"','如果请求content-type是否为xml，则触发一个xml解析器','OTHER','block',0,1452647413,NULL),(8042,958000,'检测.addImport(OWASP TOP 10)','\\.addimport\\b',' 检测请求数据中的.addImport关键词','XSS','block',1,1395124100,NULL),(8034,958001,'检测document.cookie(OWASP TOP 10)','\\bdocument\\b\\s*\\.\\s*\\bcookie\\b',' 检测请求数据中的document.cookie关键词','XSS','block',1,1395124100,NULL),(8018,958002,'检测.execscript(OWASP TOP 10)','\\.execscript\\b',' 检测请求数据中的.execscript关键词','XSS','block',1,1395124100,NULL),(8071,958003,'检测.fromcharcode(OWASP TOP 10)','\\.fromcharcode\\b',' 检测请求数据中的.fromcharcode关键词','XSS','block',1,1395124100,NULL),(8057,958004,'检测.innerhtml(OWASP TOP 10)','\\.innerhtml\\b',' 检测请求数据中的.innerhtml关键词','XSS','block',1,1395124100,NULL),(8035,958005,'检测<![cdata[(OWASP TOP 10)','\\<\\!\\[cdata\\[',' 检测请求数据中的<![cdata[关键词','XSS','block',1,1395124100,NULL),(8030,958006,'检测body标签的background(OWASP TOP 10)','<body\\b.*?\\bbackground\\b',' 检测body标签的background','XSS','block',1,1395124100,NULL),(8020,958007,'检测boby标签的中的onload(OWASP TOP 10)','<body\\b.*?\\bonload\\b',' 检测请求数据boby标签的中的onload关键词','XSS','block',1,1395124100,NULL),(8068,958008,'检测input中的type是否包含image(OWASP TOP 10)','<input\\b.*?\\btype\\b\\W*?\\bimage\\b',' 检测input中的type是否包含image','XSS','block',1,1395124100,NULL),(8059,958009,'检测@import(OWASP TOP 10)','\\@import\\b',' 检测请求数据中的@import关键词','XSS','block',1,1395124100,NULL),(8038,958010,'检测activexobject(OWASP TOP 10)','\\bactivexobject\\b',' 检测请求数据中的activexobject关键词','XSS','block',1,1395124100,NULL),(8066,958011,'检测background-image(OWASP TOP 10)','\\bbackground-image:',' 检测请求数据中的background-image关键词','XSS','block',1,1395124100,NULL),(8016,958012,'检测copyparentfolder(OWASP TOP 10)','\\bcopyparentfolder\\b',' 检测请求数据中的copyparentfolder关键词','XSS','block',1,1395124100,NULL),(8014,958013,'检测createtextrange(OWASP TOP 10)','\\bcreatetextrange\\b',' 检测请求数据中的createtextrange关键词','XSS','block',1,1395124100,NULL),(8005,958016,'检测getparentfolder(OWASP TOP 10)','\\bgetparentfolder\\b',' 检测请求数据中的getparentfolder关键词，包括请求参数和cookie','XSS','block',1,1395124100,NULL),(8019,958017,'检测getspecialfolder(OWASP TOP 10)','\\bgetspecialfolder\\b',' 检测请求数据中的getspecialfolder关键词','XSS','block',1,1395124100,NULL),(8043,958018,'检测href是否包含javascript代码(OWASP TOP 10)','\\bhref\\b\\W*?\\bjavascript:',' 检测href是否包含javascript代码','XSS','block',1,1395124100,NULL),(8013,958019,'检测href中中是否包含shell代码(OWASP TOP 10)','\\bhref\\b\\W*?\\bshell:','','XSS','block',1,1395124100,NULL),(8055,958020,'检测href中是否包含vbscript代码(OWASP TOP 10)','\\bhref\\b\\W*?\\bvbscript:',' 检测href中是否包含vbscript代码','XSS','block',1,1395124100,NULL),(8024,958022,'检测livescript(OWASP TOP 10)','\\blivescript:',' 检测请求数据中的livescript关键词','XSS','block',1,1395124100,NULL),(8037,958023,'检测lowsrc中是否包含javascript代码(OWASP TOP 10)','\\blowsrc\\b\\W*?\\bjavascript:',' 检测lowsrc中是否包含javascript代码','XSS','block',1,1395124100,NULL),(8052,958024,'检测src是否包含shell代码(OWASP TOP 10)','\\blowsrc\\b\\W*?\\bshell:',' 检测src是否包含shell代码','XSS','block',1,1395124100,NULL),(8060,958025,'检测lowsrc中是否包含vbscript代码(OWASP TOP 10)','\\blowsrc\\b\\W*?\\bvbscript:',' 检测lowsrc中是否包含vbscript代码','XSS','block',1,1395124100,NULL),(8008,958026,'检测mocha(OWASP TOP 10)','\\bmocha:',' 检测请求数据中的mocha:关键词','XSS','block',1,1395124100,NULL),(8009,958027,'检测onabort(OWASP TOP 10)','\\bonabort\\b',' 检测请求数据中的onabort关键词','XSS','block',1,1395124100,NULL),(8027,958028,'检测settimeout(OWASP TOP 10)','\\bsettimeout\\b\\W*?\\(',' 检测请求数据中的settimeout关键词','XSS','block',1,1395124100,NULL),(8049,958030,'检测src中是否是http(OWASP TOP 10)','\\bsrc\\b\\W*?\\bhttp:',' 检测src中是否是http','XSS','block',1,1395124100,NULL),(8029,958031,'检测src中是否包含javascript代码(OWASP TOP 10)','\\bsrc\\b\\W*?\\bjavascript:',' 检测src中是否包含javascript代码','XSS','block',1,1395124100,NULL),(8007,958032,'检测src shell:(OWASP TOP 10)','\\bsrc\\b\\W*?\\bshell:',' 检测请求数据中的src shell:关键词','XSS','block',1,1395124100,NULL),(8031,958033,'检测src中是否包含vbscript代码(OWASP TOP 10)','\\bsrc\\b\\W*?\\bvbscript:',' 检测src中是否包含vbscript代码','XSS','block',1,1395124100,NULL),(8012,958034,'检测css expression(expression可以包含js代码, )(OWASP TOP 10)','\\bstyle\\b\\W*\\=.*bexpression\\b\\W*\\(','expression可以包含js代码','XSS','block',1,1395124100,NULL),(8041,958036,'检测type中application是否包含x-javascript代码(OWASP TOP 10)','\\btype\\b\\W*?\\bapplication\\b\\W*?\\bx-javascript\\b',' 检测type中application是否包含x-javascript代码','XSS','block',1,1395124100,NULL),(8047,958037,'检测type中的application是否包含vbscript代码(OWASP TOP 10)','\\btype\\b\\W*?\\bapplication\\b\\W*?\\bx-vbscript\\b',' 检测type中的application是否包含vbscript代码','XSS','block',1,1395124100,NULL),(8032,958038,'检测type中text中是否包含ecmascript代码(OWASP TOP 10)','\\btype\\b\\W*?\\btext\\b\\W*?\\becmascript\\b',' 检测type中text中是否包含ecmascript代码','XSS','block',1,1395124100,NULL),(8070,958039,'检测type中的text是否包含javascript代码(OWASP TOP 10)','\\btype\\b\\W*?\\btext\\b\\W*?\\bjavascript\\b',' 检测type中的text是否包含javascript代码','XSS','block',1,1395124100,NULL),(8045,958040,'检测type的text中是否包含javascript代码(OWASP TOP 10)','\\btype\\b\\W*?\\btext\\b\\W*?\\bjscript\\b',' 检测type的text中是否包含javascript代码','XSS','block',1,1395124100,NULL),(8050,958041,'检测type中的text是否包含vbscript代码(OWASP TOP 10)','\\btype\\b\\W*?\\btext\\b\\W*?\\bvbscript\\b',' 检测type中的text是否包含vbscript代码','XSS','block',1,1395124100,NULL),(8056,958045,'检测url中是否包含javascript代码(OWASP TOP 10)','\\burl\\b\\W*?\\bjavascript:',' 检测url中是否包含javascript代码','XSS','block',1,1395124100,NULL),(8069,958046,'检测url中是否包含shell代码(OWASP TOP 10)','\\burl\\b\\W*?\\bshell:',' 检测url中是否包含shell代码','XSS','block',1,1395124100,NULL),(8021,958047,'检测url中是否包含vbscript代码(OWASP TOP 10)','\\burl\\b\\W*?\\bvbscript:','','XSS','block',1,1395124100,NULL),(8048,958049,'检测meta(OWASP TOP 10)','\\< ?meta\\b',' 检测请求数据中的meta关键词','XSS','block',1,1395124100,NULL),(8062,958051,'检测script标签的开始(OWASP TOP 10)','\\< ?script\\b',' 检测请求数据中的<script关键词','XSS','block',1,1395124100,NULL),(8046,958052,'检测alert(OWASP TOP 10)','\\balert\\b\\W*?\\(',' 检测请求数据中的alert关键词','XSS','block',1,1395124100,NULL),(8010,958054,'检测lowsrc http:(OWASP TOP 10)','\\blowsrc\\b\\W*?\\bhttp:',' 检测请求数据中的lowsrc http:关键词','XSS','block',1,1395124100,NULL),(8065,958056,'检测iframe中的src(OWASP TOP 10)','\\biframe\\b.{0,100}?\\bsrc\\b',' 检测iframe中的src','XSS','block',1,1395124100,NULL),(8028,958057,'检测iframe(OWASP TOP 10)','\\< ?iframe',' 检测请求数据中的iframe关键词','XSS','block',1,1395124100,NULL),(8053,958059,'检测asfunction(OWASP TOP 10)','\\basfunction:',' 检测请求数据中的asfunction关键词','XSS','block',1,1395124100,NULL),(8036,958404,'检测onerror(OWASP TOP 10)','\\bonerror\\b\\W*?\\=',' 检测请求数据中的onerror关键词','XSS','block',1,1395124100,NULL),(8025,958405,'检测onblur(OWASP TOP 10)','\\bonblur\\b\\W*?\\=',' 检测请求数据中的onblur关键词','XSS','block',1,1395124100,NULL),(8044,958406,'检测onchange(OWASP TOP 10)','\\bonchange\\b\\W*?\\=',' 检测请求数据中的onchange关键词','XSS','block',1,1395124100,NULL),(8064,958407,'检测onclick(OWASP TOP 10)','\\bonclick\\b\\W*?\\=',' 检测请求数据中的onclick关键词','XSS','block',1,1395124100,NULL),(8015,958408,'检测ondragdrop(OWASP TOP 10)','\\bondragdrop\\b\\W*?\\=',' 检测请求数据中的ondragdrop关键词','XSS','block',1,1395124100,NULL),(8033,958409,'检测onfocus(OWASP TOP 10)','\\bonfocus\\b\\W*?\\=',' 检测请求数据中的onfocus关键词','XSS','block',1,1395124100,NULL),(8022,958410,'检测onkeydown(OWASP TOP 10)','\\bonkeydown\\b\\W*?\\=',' 检测请求数据中的onkeydown关键词','XSS','block',1,1395124100,NULL),(8039,958411,'检测onkeypress(OWASP TOP 10)','\\bonkeypress\\b\\W*?\\=',' 检测请求数据中的onkeypress关键词','XSS','block',1,1395124100,NULL),(8067,958412,'检测onkeyup(OWASP TOP 10)','\\bonkeyup\\b\\W*?\\=',' 检测请求数据中的onkeyup关键词','XSS','block',1,1395124100,NULL),(8061,958413,'检测onload(OWASP TOP 10)','\\bonload\\b\\W*?\\=',' 检测请求数据中的onload关键词','XSS','block',1,1395124100,NULL),(8006,958414,'检测onmousedown(OWASP TOP 10)','\\bonmousedown\\b\\W*?\\=',' 检测请求数据中的onmousedown关键词','XSS','block',1,1395124100,NULL),(8023,958415,'检测onmousemove(OWASP TOP 10)','\\bonmousemove\\b\\W*?\\=',' 检测请求数据中的onmousemove关键词','XSS','block',1,1395124100,NULL),(8051,958416,'检测onmouseout(OWASP TOP 10)','\\bonmouseout\\b\\W*?\\=',' 检测请求数据中的onmouseout关键词','XSS','block',1,1395124100,NULL),(8054,958417,'检测onmouseover(OWASP TOP 10)','\\bonmouseover\\b\\W*?\\=',' 检测请求数据中的onmouseover关键词','XSS','block',1,1395124100,NULL),(8011,958418,'检测onmouseup(OWASP TOP 10)','\\bonmouseup\\b\\W*?\\=',' 检测请求数据中的onmouseup关键词','XSS','block',1,1395124100,NULL),(8026,958419,'检测onmove(OWASP TOP 10)','\\bonmove\\b\\W*?\\=',' 检测请求数据中的onmove关键词','XSS','block',1,1395124100,NULL),(8063,958420,'检测onresize(OWASP TOP 10)','\\bonresize\\b\\W*?\\=',' 检测请求数据中的onresize关键词','XSS','block',1,1395124100,NULL),(8058,958421,'检测onselect(OWASP TOP 10)','\\bonselect\\b\\W*?\\=',' 检测请求数据中的onselect关键词','XSS','block',1,1395124100,NULL),(8040,958422,'检测onsubmit(OWASP TOP 10)','\\bonsubmit\\b\\W*?\\=',' 检测请求数据中的onsubmit关键词','XSS','block',1,1395124100,NULL),(8017,958423,'检测onunload(OWASP TOP 10)','\\bonunload\\b\\W*?\\=',' 检测请求数据中的onunload关键词','XSS','block',1,1395124100,NULL),(8072,973300,'xss常规异常检测(OWASP TOP 10)','<(a|abbr|acronym|address|applet|area|audioscope|b|base|basefront|bdo|bgsound|big|blackface|blink|blockquote|body|bq|br|button|caption|center|cite|code|col|colgroup|comment|dd|del|dfn|dir|div|dl|dt|em|embed|fieldset|fn|font|form|frame|frameset|h1|head|hr|h',' 通过在请求内容中检测address、applet、area、audioscope、basefront等关键词来检测可能的xss攻击','XSS','block',1,1395124100,NULL),(8073,973301,'检测allowscriptaccess、rel=(OWASP TOP 10)','\\ballowscriptaccess\\b|\\brel\\b\\W*?=',' 通过在请求内容中检测allowscriptaccess、 rel=来检测XSS攻击','XSS','block',1,1395124100,NULL),(8074,973302,'检测application/x-shockwave-flash|image/svg+xml(OWASP TOP 10)','.+application/x-shockwave-flash|image/svg\\+xml|text/(css|html|ecmascript|javascript|vbscript|x-(javascript|scriptlet|vbscript)).+',' 通过在请求内容中检测application/x-shockwave-flash、image/svg+xml、text/css、text/javascript等来检测XSS攻击','XSS','block',1,1395124100,NULL),(8075,973303,'检测各个事件(OWASP TOP 10)','\\bon(abort|blur|change|click|dblclick|dragdrop|error|focus|keydown|keypress|keyup|load|mousedown|mousemove|mouseout|mouseover|mouseup|move|readystatechange|reset|resize|select|submit|unload)\\b\\W*?=',' 通过在请求内容中检测事件处理的名字，来检测xss攻击，如：<body onload=...>    <img src=x onerror=...>等','XSS','block',1,1395124100,NULL),(8076,973304,'利用通用URI属性来进行XSS攻击(OWASP TOP 10)','\\b(background|dynsrc|href|lowsrc|src)\\b\\W*?=',' 检测利用通用URI属性来上传数据进行XSS攻击，如：<a href="javascript:...">Link</a> ，<img src=javascript:...>等','XSS','block',1,1395124100,NULL),(8077,973305,'变种的（隐蔽的）利用通用URI属性来进行XSS攻击(OWASP TOP 10)','(asfunction|javascript|vbscript|data|mocha|livescript):',' 检测一些隐藏的利用通用URI属性来上传数据进行XSS攻击，如：<img src=jaVaScrIpt:...>， <img src="jaa&#09;ascript:...">等','XSS','block',1,1395124100,NULL),(8078,973306,'通过style属性来进行的XSS攻击(OWASP TOP 10)','\\bstyle\\b\\W*?=',' 检测通过利用style属性来进行的XSS攻击，比较典型的如：<div style="background-image: url(javascript:...)">','XSS','block',1,1395124100,NULL),(8079,973307,'javascript片段检测(OWASP TOP 10)','(fromcharcode|alert|eval)\\s*\\(',' 通过检测javascript程序片段来检测XSS攻击，比如如下片段：alert(String.fromCharCode(88,83,83) window.execScript(\"alert(\'test\');\", \"JavaScript\");...','XSS','block',1,1395124100,NULL),(8080,973308,'css攻击片段检测(OWASP TOP 10)','background\\b\\W*?:\\W*?url|background-image\\b\\W*?:|behavior\\b\\W*?:\\W*?url|-moz-binding\\b|@import\\b|expression\\b\\W*?\\(',' 检测CSS中的XSS攻击片段。如：<div style=\"background-image: url(javascript:...)\">等。','XSS','block',1,1395124100,NULL), (8081,973309,'检测<![CDATA[中的可疑行为(OWASP TOP 10)','<!\\[cdata\\[|\\]\\]>','检测<![CDATA[中的可能XSS攻击，如：<C><![CDATA[<IMG SRC=\"javas]]><![CDATA[cript:alert(\'XSS\');\">]]></C>','XSS','block',1,1395124100,NULL),(8082,973310,'检测包含xss的javascript代码或标签等(OWASP TOP 10)','[/\'\\\"<]xss[/\'\\\">]',' 检测包含xss的javascript代码或标签等，如：alert(/xss/)','XSS','block',1,1395124100,NULL),(8083,973311,'检测(88,83,83)(OWASP TOP 10)','(88,83,83)',' 检测(88,83,83)，如：String.fromCharCode(88,83,83)','XSS','block',1,1395124100,NULL), (8084,973312,'检测可疑符号及xss标签(OWASP TOP 10)','\'\';!--\\\"<xss>=&{}',' 检测可疑符号及xss标签，如：\'\';!--\"<XSS>=&{()}','XSS','block',1,1395124100,NULL),(8085,973313,'检测&{(OWASP TOP 10)','&{',' 检测&{，如：&{alert(\'xss\')}，这个在Netscape 4中会执行','XSS','block',1,1395124100,NULL),(8086,973314,'利用<!(doctype|entity)标签的XSS(OWASP TOP 10)','<!(doctype|entity)',' 检测可能的利用<!(doctype，<!ENTITY进行的XSS，如：<!DOCTYPE html [  <!ENTITY inject \"&#60;script&#62;alert(1)&#60;/script&#62;\"> ]>','XSS','block',1,1395124100,NULL), (8088,973315,'针对IE的XSS过滤2(OWASP TOP 10)','(?i:<style.*?>.*?((@[i\\\\\\\\])|(([:=]|(&#x?0*((58)|(3A)|(61)|(3D));?)).*?([(\\\\\\\\]|(&#x?0*((40)|(28)|(92)|(5C));?)))))',' 检测针对IE的如下内容，如： <style ...>@i...','XSS','block',1,1395124100,NULL),(8110,973316,'针对IE的XSS过滤24(OWASP TOP 10)','(?i:[ /+\\t\\\"\\\'`]style[ /+\\t]*?=.*([:=]|(&#x?0*((58)|(3A)|(61)|(3D));?)).*?([(\\\\\\\\]|(&#x?0*((40)|(28)|(92)|(5C));?)))',' 测针对IE的特殊编码内容，如： style=...&#x0058;...&#x0040;','XSS','block',1,1395124100,NULL),(8101,973317,'针对IE的XSS过滤15(OWASP TOP 10)','(?i:<OBJECT[ /+\\t].*?((type)|(codetype)|(classid)|(code)|(data))[ /+\\t]*=)',' 检测针对IE的如下内容，如： <OBJECT type = ...','XSS','block',1,1395124100,NULL),(8100,973318,'针对IE的XSS过滤14(OWASP TOP 10)','(?i:<APPLET[ /+\\t>])',' 检测针对IE的如下内容，如： <APPLET> ...','XSS','block',1,1395124100,NULL),(8112,973319,'检测datasrc','(?i:[ /+\\t\\\"\\\'`]datasrc[ +\\t]*?=.)','','XSS','block',1,1395124100,NULL),(8099,973320,'针对IE的XSS过滤13(OWASP TOP 10)','(?i:<BASE[ /+\\t].*?href[ /+\\t]*=)',' 检测针对IE的如下内容，如： <BASE href = ...','XSS','block',1,1395124100,NULL),(8098,973321,'针对IE的XSS过滤12(OWASP TOP 10)','(?i:<LINK[ /+\\t].*?href[ /+\\t]*=)',' 检测针对IE的如下内容，如： <LINK href = ...','XSS','block',1,1395124100,NULL),(8096,973322,'针对IE的XSS过滤10(OWASP TOP 10)','(?i:<META[ /+\\t].*?http-equiv[ /+\\t]*=[ /+\\t]*[\\\"\\\'`]?(((c|(&#x?0*((67)|(43)|(99)|(63));?)))|((r|(&#x?0*((82)|(52)|(114)|(72));?)))|((s|(&#x?0*((83)|(53)|(115)|(73));?)))))',' 检测针对IE的如下内容，如： <META http-equiv = ...','XSS','block',1,1395124100,NULL),(8095,973323,'针对IE的XSS过滤9(OWASP TOP 10)','(?i:<[?]?import[ /+\\t].*?implementation[ /+\\t]*=)',' 检测针对IE的如下内容，如： <import implementation= <EMBED src=....','XSS','block',1,1395124100,NULL),(8094,973324,'针对IE的XSS过滤8(OWASP TOP 10)','(?i:<EMBED[ /+\\t].*?((src)|(type)).*?=)',' 检测针对IE的如下内容，如： <EMBED src=....','XSS','block',1,1395124100,NULL),(8111,973325,'针对IE的XSS过滤25(OWASP TOP 10)','(?i:[ /+\\t\\\"\\\'`]on\\[a-z]\\[a-z]\\[a-z]+?[ +\\t]*?=.)','检测针对IE的内容，如： /on...] =...','XSS','block',1,1395124100,NULL),(8091,973326,'针对IE的XSS过滤5(OWASP TOP 10)','(?i:<.*[:]vmlframe.*?[ /+\\t]*?src[ /+\\t]*=)',' 检测针对IE的如下内容，如： <:vmlframe src=....','XSS','block',1,1395124100,NULL),(8090,973327,'针对IE的XSS过滤4(OWASP TOP 10)','(?i:<[i]?frame.*?[ /+\\t]*?src[ /+\\t]*=)',' 检测针对IE的如下内容，如： <iframe src=....','XSS','block',1,1395124100,NULL),(8109,973328,'针对IE的XSS过滤23(OWASP TOP 10)','(?i:<isindex[ /+\\t>])',' 检测针对IE的内容，如： <isindex>...','XSS','block',1,1395124100,NULL),(8108,973329,'针对IE的XSS过滤22(OWASP TOP 10)','(?i:<form.*?>)',' 检测针对IE的内容，如： <form...>','XSS','block',1,1395124100,NULL),(8089,973330,'针对IE的XSS过滤3(OWASP TOP 10)','(?i:<script.*?[ /+\\t]*?((src)|(xlink:href)|(href))[ /+\\t]*=)',' 检测针对IE的如下内容，如： <script src=....','XSS','block',1,1395124100,NULL),(8087,973331,'针对IE的XSS过滤1(OWASP TOP 10)','(?i:<script.*?>)',' 检测针对IE的如下内容，如： <script ...>...','XSS','block',1,1395124100,NULL),(8107,973332,'针对IE的XSS过滤21(OWASP TOP 10)','(?i:[\\\"\\\'][ ]*(([^a-z0-9~\\_:\\\' ])|(in)).*?(((l|(\\\\\\\\u006C))(o|(\\\\\\\\u006F))(c|(\\\\\\\\u0063))(a|(\\\\\\\\u0061))(t|(\\\\\\\\u0074))(i|(\\\\\\\\u0069))(o|(\\\\\\\\u006F))(n|(\\\\\\\\u006E)))|((n|(\\\\\\\\u006E))(a|(\\\\\\\\u0061))(m|(\\\\\\\\u006D))(e|(\\\\\\\\u0065)))|((o|(\\\\\\\\u006F))(n|(\\\\\\\\u006E))(e|(\\\\\\\\u0065))(r|(\\\\\\\\u0072))(r|(\\\\\\\\u0072))(o|(\\\\\\\\u006F))(r|(\\\\\\\\u0072)))|((v|(\\\\\\\\u0076))(a|(\\\\\\\\u0061))(l|(\\\\\\\\u006C))(u|(\\\\\\\\u0075))(e|(\\\\\\\\u0065))(O|(\\\\\\\\u004F))(f|(\\\\\\\\u0066)))).*?=)',' 检测针对IE的特殊编码内容，如： \" in ... \\\\u006C\\\\u006F...','XSS','block',1,1395124100,NULL),(8104,973334,'针对IE的XSS过滤18(OWASP TOP 10)','(?i:[\\\"\\\'].*?\\)[ ]*(([^a-z0-9~\\_:\\\' ])|(in)).+?\\',' 检测针对IE的内容，如： \"...) in ...(...','XSS','block',1,1395124100,NULL),(8103,973335,'针对IE的XSS过滤17(OWASP TOP 10)','(?i:[\\\"\\\'][ ]*(([^a-z0-9~\\_:\\\' ])|(in)).+?\\(.*?\\))',' 检测针对IE的内容，如： \" in ...(...)','XSS','block',1,1395124100,NULL),(8000,973336,'基于script标签的XSS过滤(OWASP TOP 10)','(?i)(<script[^>]*>[\\s\\S]*?<\\/script[^>]*>|<script[^>]*>[\\s\\S]*?<\\/script[[\\s\\S]]*[\\s\\S]|<script[^>]*>[\\s\\S]*?<\\/script[\\s]*[\\s]|<script[^>]*>[\\s\\S]*?<\\/script|<script[^>]*>[\\s\\S]*?)','script标签的过滤，如：<script> alert(1)</script>','XSS','pass',0,1395124100,NULL), (8001,973337,'基于事件处理的XSS过滤(OWASP TOP 10)','(?i)([\\s\\\"\'`;\\/0-9\\=]+on\\w+\\s*=)','基于onload,onerror事件等的XSS,如： <body onload=\"alert(1)\">','XSS','pass',1,1395124100,NULL),(8002,973338,'基于javascript uri的XSS过滤(OWASP TOP 10)','(?i)((?:=|U\\s*R\\s*L\\s*\\\\s*[^>]*\\s*S\\s*C\\s*R\\s*I\\s*P\\s*T\\s*:|&colon;|[\\s\\S]allowscriptaccess[\\s\\S]|[\\s\\S]src[\\s\\S]|[\\s\\S]data:text\\/html[\\s\\S]|[\\s\\S]xlink:href[\\s\\S]|[\\s\\S]base64[\\s\\S]|[\\s\\S]xmlns[\\s\\S]|[\\s\\S]xhtml[\\s\\S]|[\\s\\S]style[\\s\\S]|<style[^>]*>[\\s\\S',' 基于javascript uri的XSS攻击，如：<p style="background:url(javascript:alert(1))">','XSS','pass',1,1395124100,NULL),(8106,973344,'针对IE的XSS过滤20(OWASP TOP 10)','(?i:[\\\"\\\'][ ]*(([^a-z0-9~\\_:\\\' ])|(in)).+?[\\[].*?[\\]].*?=)',' 检测针对IE的内容，如： \" in ... [...]...=','XSS','block',1,1395124100,NULL),(8093,973345,'针对IE的XSS过滤7(OWASP TOP 10)','(?i:(v|(&#x?0*((86)|(56)|(118)|(76));?))([\\t]|(&((#x?0*(9|(13)|(10)|A|D);?)|(tab;)|(newline;))))*(b|(&#x?0*((66)|(42)|(98)|(62));?))([\\t]|(&((#x?0*(9|(13)|(10)|A|D);?)|(tab;)|(newline;))))*(s|(&#x?0*((83)|(53)|(115)|(73));?))([\\t]|(&((#x?0*(9|(13)|(10)|A|',' 检测针对IE内容编码，如：&#x0086、&#x0056;等','XSS','block',1,1395124100,NULL),(8092,973346,'针对IE的XSS过滤6(OWASP TOP 10)','(?i:(j|(&#x?0*((74)|(4A)|(106)|(6A));?))([\\t]|(&((#x?0*(9|(13)|(10)|A|D);?)|(tab;)|(newline;))))*(a|(&#x?0*((65)|(41)|(97)|(61));?))([\\t]|(&((#x?0*(9|(13)|(10)|A|D);?)|(tab;)|(newline;))))*(v|(&#x?0*((86)|(56)|(118)|(76));?))([\\t]|(&((#x?0*(9|(13)|(10)|A|',' 检测针对IE内容编码，如：&#x0074、&#x004A;等','XSS','block',1,1395124100,NULL),(8102,973347,'针对IE的XSS过滤16(OWASP TOP 10)','(?i:[\\\"\\\'].*?[,].*(((v|(\\\\\\\\u0076)|(\\\\166)|(\\\\x76))[^a-z0-9]*(a|(\\\\\\\\u0061)|(\\\\141)|(\\\\x61))[^a-z0-9]*(l|(\\\\\\\\u006C)|(\\\\154)|(\\\\x6C))[^a-z0-9]*(u|(\\\\\\\\u0075)|(\\\\165)|(\\\\x75))[^a-z0-9]*(e|(\\\\\\\\u0065)|(\\\\145)|(\\\\x65))[^a-z0-9]*(O|(\\\\\\\\u004F)|(\\\\117)|(\\\\x4F))[^a-z0-9]*(f|(\\\\\\\\u0066)|(\\\\146)|(\\\\x66)))|((t|(\\\\\\\\u0074)|(\\\\164)|(\\\\x74))[^a-z0-9]*(o|(\\\\\\\\u006F)|(\\\\157)|(\\\\x6F))[^a-z0-9]*(S|(\\\\\\\\u0053)|(\\\\123)|(\\\\x53))[^a-z0-9]*(t|(\\\\\\\\u0074)|(\\\\164)|(\\\\x74))[^a-z0-9]*(r|(\\\\\\\\u0072)|(\\\\162)|(\\\\x72))[^a-z0-9]*(i|(\\\\\\\\u0069)|(\\\\151)|(\\\\x69))[^a-z0-9]*(n|(\\\\\\\\u006E)|(\\\\156)|(\\\\x6E))[^a-z0-9]*(g|(\\\\\\\\u0067)|(\\\\147)|(\\\\x67)))).*?:)',' 检测针对IE的特殊编码内容，如： \\\\u0074 \\\\u0076等。','XSS','block',1,1395124100,NULL),(8097,973348,'针对IE的XSS过滤11(OWASP TOP 10)','(?i:<META[ /+\\t].*?charset[ /+\\t]*=)',' 检测针对IE的如下内容，如： <META charset = ...','XSS','block',1,1395124100,NULL),(8004,981018,'检测异常分数是否为0（XSS Attacks)','@eq 0','','XSS','pass',1,1395124100,NULL),(8003,981136,'常规异常检测','@pm jscript onsubmit copyparentfolder document javascript meta onchange onmove onkeydown onkeyup activexobject onerror onmouseup ecmascript bexpression onmouseover vbscript: <![cdata[ http: .innerhtml settimeout shell: onabort asfunction: onkeypress onmou','','XSS','pass',1,1395124100,NULL);
update t_rules set status = 0 where id = 1001;
update t_rules set status = 0 where id = 1002;
update t_rules set status = 0 where id = 1003;
update t_rules set status = 0 where id = 1004;
update t_rules set status = 0 where id = 1030;
update t_rules set status = 0 where id = 1031;
update t_rules set status = 0 where id = 1035;
update t_rules set status = 0 where id = 1049;
update t_rules set status = 0 where id = 1053;
update t_rules set status = 0 where id = 3023;
