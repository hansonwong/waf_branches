<?php
namespace app\controllers;

use Yii;
use app\logic\BaseController;

/**
 * 安全管理 - 安全管理 - 漏洞扫描
 */
class VulnerabilityScanController extends BaseController
{
    public $model = '\\app\\models\\ScanTask';

	public function actionDelete()
    {
        $query = Yii::$app->request->bodyParams;
        ($this->model)::checkBeforeDelete($query['id']);
        parent::actionDelete();
    }

    public function actionUpdate($id)
    {
        $get = Yii::$app->request->get();
        if(isset($get['op']) && 'scan' == $get['op']){
            return ($this->model)::scanStartAndStop($get['status'], $get['id']);
        }
        return parent::actionUpdate($id);
    }
}